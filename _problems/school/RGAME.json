{"category_name":"school","status":"success","problem_code":"RGAME","problem_name":"Rupsa and the Game","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JAN16\/mandarin\/RGAME.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JAN16\/russian\/RGAME.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JAN16\/vietnamese\/RGAME.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n\n<p>Princess Rupsa saw one of her friends playing a special game. The game goes as follows:\n<ul>\n<li><b>N+1<\/b> numbers occur sequentially (one at a time) from <b>A<sub>0<\/sup><\/b> to <b>A<sub>N<\/sub><\/b>.<\/li>\n<li>You must write the numbers on a sheet of paper, such that <b>A<sub>0<\/sub><\/b> is written first. The other numbers are written according to an inductive rule \u2014 after <b>A<sub>i-1<\/sub><\/b> numbers have been written in a row, then <b>A<sub>i<\/sub><\/b> can be written at either end of the row. That is, you first write <b>A<sub>0<\/sub><\/b>, and then <b>A<sub>1<\/sub><\/b> can be written on its left or right to make <b>A<sub>0<\/sub>A<sub>1<\/sub><\/b> or <b>A<sub>1<\/sub>A<sub>0<\/sub><\/b>, and so on.<\/li>\n<li><b>A<sub>i<\/sub><\/b> must be written before writing <b>A<sub>j<\/sub><\/b>, for every <b>i &lt; j<\/b>.<\/li>\n<li>For a move in which you write a number <b>A<sub>i<\/sub> (i>0)<\/b>, your points increase by the product of <b>A<sub>i<\/sub><\/b> and its neighbour. (Note that for any move it will have only one neighbour as you write the number at an end).<\/li>\n<li>Total score of a game is the score you attain after placing all the <b>N + 1<\/b> numbers.<\/li><\/ul><\/p>\n\n<p>Princess Rupsa wants to find out the sum of scores obtained by all possible different gameplays. Two gameplays are different, if after writing down all <b>N + 1<\/b> numbers, when we read from left to right, there exists some position <b>i<\/b>, at which the gameplays have <b>a<sub>j<\/sub><\/b> and <b>a<sub>k<\/sub><\/b> written at the <b>i<sup>th<\/sup><\/b> position such that <b>j &ne; k<\/b>. But since she has recently found her true love, a frog Prince, and is in a hurry to meet him, you must help her solve the problem as fast as possible. Since the answer can be very large, print the answer modulo <b>10<sup>9<\/sup> + 7<\/b>.<\/p>\n\n<h3>Input<\/h3>\n<ul>\n<li>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases.<\/li>\t\t\n<li>The first line of each test case contains a single integer <b>N<\/b>. <\/li>\n<li>The second line contains <b>N + 1<\/b> space-separated integers denoting <b>A<sub>0<\/sub><\/b> to <b>A<sub>N<\/sub><\/b>.<\/li>\n<\/ul> \n\n<h3>Output<\/h3>\n<ul><li>\nFor each test case, output a single line containing an integer denoting the answer.\n<\/li><\/ul>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10<sup>5<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>A<sub>i<\/b> \u2264 <b>10<sup>9<\/b><\/li>\n<\/ul>\n\n<h3>Sub tasks<\/h3>\n<ul>\n<li>Subtask #1: 1 \u2264 <b>N<\/b> \u2264 10 (10 points)<\/li>\n<li>Subtask #2: 1 \u2264 <b>N<\/b> \u2264 1000 (20 points)<\/li>\n<li>Subtask #3: Original Constraints (70 points)<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n1\n1 2\n2\n1 2 1\n\n<b>Output:<\/b>\n4\n14\n<\/pre>\n\n<h3>Explanation<\/h3>\n<ul>\n<li>There are <b>2<\/b> possible gameplays. <b>A<sub>0<\/sub>A<sub>1<\/sub><\/b> which gives score of <b>2<\/b> and  <b>A<sub>1<\/sub>A<sub>0<\/sub><\/b> which also gives score of <b>2<\/b>. So the answer is <b>2 + 2 = 4<\/b>\n<\/ul>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"abhra73","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>abhra73<\/span>","problem_tester":"mgch","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>mgch<\/span>","date_added":"11-05-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/abhra73'>\n                    abhra73\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ad-hoc'>\n                    ad-hoc\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>\n                    easy-medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/jan16'>\n                    jan16\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/RGAME","user":{"username":null},"time":{"view_start_date":1452504600,"submit_start_date":1452504600,"visible_start_date":1452504600,"end_date":1735669800,"current":1492507147},"todo":false,"problem_status":"unattempted"}