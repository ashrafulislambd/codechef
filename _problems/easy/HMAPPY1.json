
{"category_name":"easy","status":"success","problem_code":"HMAPPY1","problem_name":"Appy Loves One","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>###Read problems statements [Hindi](http:\/\/www.codechef.com\/download\/translated\/NOV18\/hindi\/HMAPPY1.pdf) , [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/NOV18\/vietnamese\/HMAPPY1.pdf) , [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/NOV18\/mandarin\/HMAPPY1.pdf) , [Russian](http:\/\/www.codechef.com\/download\/translated\/NOV18\/russian\/HMAPPY1.pdf) and [Bengali](http:\/\/www.codechef.com\/download\/translated\/NOV18\/bengali\/HMAPPY1.pdf) as well.\n\nChef has a sequence $A_1, A_2, \\ldots, A_N$; each element of this sequence is either $0$ or $1$. Appy gave him a string $S$ with length $Q$ describing a sequence of queries. There are two types of queries:\n- '!': right-shift the sequence $A$, i.e. replace $A$ by another sequence $B_1, B_2, \\ldots, B_N$ satisfying $B_{i+1} = A_i$ for each valid $i$ and $B_1 = A_N$\n- '?': find the length of the longest contiguous subsequence of $A$ with length $\\le K$ such that each element of this subsequence is equal to $1$\n\nAnswer all queries of the second type.\n\n### Input\n- The first line of the input contains three space-separated integers $N$, $Q$ and $K$.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\n- The third line contains a string with length $Q$ describing queries. Each character of this string is either '?', denoting a query of the second type, or '!', denoting a query of the first type.\n\n### Output\nFor each query of the second type, print a single line containing one integer \u2014 the length of the longest required subsequence.\n\n### Constraints \n- $1 \\le K \\le N \\le 10^5$\n- $1 \\le Q \\le 3 \\cdot 10^5$\n- $0 \\le A_i \\le 1$ for each valid $i$\n- $S$ contains only characters '?' and '!'\n\n### Subtasks\n**Subtask #1 (30 points):**\n- $1 \\le N \\le 10^3$\n- $1 \\le Q \\le 3 \\cdot 10^3$\n\n**Subtask #2 (70 points):** original constraints \n\n### Example Input\n```\n5 5 3\n1 1 0 1 1\n?!?!?\t\n```\n\n### Example Output\n```\n2\n3\n3\n```\n\n### Explanation\n- In the first query, there are two longest contiguous subsequences containing only $1$-s: $A_1, A_2$ and $A_4, A_5$. Each has length $2$.\n- After the second query, the sequence $A$ is $[1, 1, 1, 0, 1]$.\n- In the third query, the longest contiguous subsequence containing only $1$-s is $A_1, A_2, A_3$.\n- After the fourth query, $A = [1, 1, 1, 1, 0]$.\n- In the fifth query, the longest contiguous subsequence containing only $1$-s is $A_1, A_2, A_3, A_4$ with length $4$. However, we only want subsequences with lengths $\\le K$. One of the longest such subsequences is $A_2, A_3, A_4$, with length $3$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"hmrockstar","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>hmrockstar<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"25-10-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/deque'>deque<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy'>easy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hmrockstar'>hmrockstar<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/nov18'>nov18<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/HMAPPY1","time":{"view_start_date":1542015002,"submit_start_date":1542015002,"visible_start_date":1542015002,"end_date":1735669800,"current":1559472947},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}