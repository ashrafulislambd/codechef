
{"category_name":"easy","status":"success","problem_code":"SJ1","problem_name":"Playing with Numbers","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/hindi\/SJ1.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/bengali\/SJ1.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/mandarin\/SJ1.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/russian\/SJ1.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/vietnamese\/SJ1.pdf) as well.\n\nYou are given a rooted tree with $N$ nodes (numbered $1$ through $N$); node $1$ is the root. For each valid $i$, the $i$-th node has a value $v_i$ and another parameter $m_i$.\n\nA leaf is a node without sons. Let's denote the number of leaf nodes in the tree by $L$ and their numbers by $l_1, l_2, \\ldots, l_L$, in increasing order. Then, for each valid $i$, let's define the *answer* for the leaf $l_i$ in the following way:\n- Consider the path from the root to $l_i$. For each node on this path (including the root and this leaf), choose a non-negative integer and multiply the value of this node by it.\n- Sum up the resulting values of all nodes on this path.\n- The answer $a_i$ for this leaf is defined as the maximum possible remainder of this sum modulo $m_{l_i}$.\n\nFind the answers for all leaves.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains a single integer $N$.\n- Each of the following $N-1$ lines contains two space-separated integers $x$ and $y$ denoting that nodes $x$ and $y$ are connected by an edge.\n- The next line contains $N$ space-separated integers $v_1, v_2, \\ldots, v_N$.\n- The last line contains $N$ space-separated integers $m_1, m_2, \\ldots, m_N$.\n\n### Output\nFor each test case, print a single line containing $L$ space-separated integers $a_1, a_2, \\ldots, a_L$.\n\n### Constraints \n- $1 \\le T \\le 8$\n- $2 \\le N \\le 10^5$\n- $1 \\le x, y \\le N$\n- $1 \\le v_i \\le 10^{18}$ for each valid $i$\n- $1 \\le m_i \\le 10^{18}$ for each valid $i$\n- the graph described on the input is a tree\n\n### Subtasks\n**Subtask #1 (100 points):** original constraints\n\n### Example Input\n```\n1\n5\n1 2\n2 5\n1 3\n3 4\n2 3 4 6 7\n1 2 3 2 10\n```\n\n### Example Output\n```\n0 9\n```\n\n### Explanation\n**Example case 1:** There are only two leaves, $l_1 = 4$ and $l_2 = 5$. The answers for them are $a_1 = 0$ and $a_2 = 9$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, R, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"sj1397","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>sj1397<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"19-03-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/april19'>april19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/easy'>easy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/gcd'>gcd<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/number-theory'>number-theory<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sj1397'>sj1397<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/SJ1","time":{"view_start_date":1555320602,"submit_start_date":1555320602,"visible_start_date":1555320602,"end_date":1735669800,"current":1559472959},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}