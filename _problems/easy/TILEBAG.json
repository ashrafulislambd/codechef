
{"category_name":"easy","status":"success","problem_code":"TILEBAG","problem_name":"Bag of Tiles","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>Kajaria has an empty bag and 2 types of tiles - \ntiles of type $1$ have the number $X$ written and those of type $2$ have the number $Y$ written on them. He has an infinite supply of both type of tiles.\n\nIn one move, Kajaria adds exactly $1$ tile to the bag. He adds a tile of type $1$ with probability $p$ and a tile of type $2$ with probability $(1 - p)$.\n\nIf $2$ tiles in the bag have the same number written on them (say $Z$), they are merged into a single tile of twice that number ($2Z$).\nFind the expected number of moves to reach the first tile with number $S$ written on it.\n\n**Notes on merging**: \n- Consider that the bag contains tiles $(5, 10, 20, 40)$ and if the new tile added is $5$, then it would merge with the existing $5$ and the bag would now contain $(10, 10, 20, 40)$. The tiles $10$ (already present) and $10$ (newly formed) would then merge in the same move to form $(20, 20, 40)$, and that will form $(40, 40)$, which will form $(80)$.\n\nKajaria guarantees that:\n- $X$ and $Y$ are not divisible by each other.\n- A tile with number $S$ can be formed.\n\n###Input\n- First line contains a single integer $T$ - the total no. of testcases\n- Each testcase is described by $2$ lines:\n1. $X, Y, S$ - $3$ space-separated natural numbers\n2. $u, v$ - $2$ space-separated natural numbers describing the probability $p$\nThe value of $p$ is provided as a fraction in its lowest form $u\/v$ ($u$ and $v$ are co-prime)\n\n###Output\n- For each testcase, if the expected number of moves can be expressed as a fraction $p\/q$ in its lowest form, print $(p * q^{-1})$ modulo $10^9 + 7$, where $q^{-1}$ denotes the modular inverse of $q$ wrt $10^9 + 7$.\n\n###Constraints\n- $1 \\leq T \\leq 10^5$\n- $2 \\leq X, Y \\leq 5 * 10^{17}$\n- $1 \\leq S \\leq 10^{18}$\n- $1 \\leq u < v \\leq 10^{9}$\n\n###Sample Input\n```\n1\n5 3 96\n1 3\n```\n\n###Sample Output\n```\n48\n```","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"wittyceaser","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #1E7D22;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>2&#9733;<\/span><span>wittyceaser<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"21-12-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/wittyceaser'>wittyceaser<\/a>","time":{"view_start_date":1545503400,"submit_start_date":1545503400,"visible_start_date":1545503400,"end_date":1735669800,"current":1559472962},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}