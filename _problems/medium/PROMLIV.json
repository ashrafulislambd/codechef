
{"category_name":"medium","status":"success","problem_code":"PROMLIV","problem_name":"I Promised to Fight for the Living","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>**Jaime Lannister** has abandoned his sister and lover **Cersei**, and now has come to Winterfell to fight against **the army of the dead**.  \n\nHe along with others has to study the weaknesses of White Waker Army.  \n\nThis can be done by monitoring $N$ strings. The $N$ strings are $A_1, A_2, \\ldots, A_N$. $A_i$ is said to be the string with index $i$.\nHe with Bronn has to make a **set S comprising all substrings of all of the $N$ strings**.     \n**Note - Set always comprises unique elements.**   \n\nLet's say there are 2 strings **abad** and **abab**.   \n**Set S** will be **{ abad, aba, ab, a, bad, ba, b, ad, bab, d, abab }**.      \n\nAlso, each substring mentioned in set **S** has **parent strings**, where each parent string is \none of the initial $N$ strings.\nIf $B$ is an element of $S$, then $A_i$ is **parent string** of $B$ if $B$ is substring of $A_i$.      \nIn the above mentioned example **ab** has both **abab** and **abad** as its parent strings. **bad** has just **abad** as its parent string.    \n\n Jaime has to handle $Q$ different queries on these strings.     \nEach query is of the following form -  \n$X$ $Y$      \nHere $X (1\\leq X \\leq N)$ denotes the index of string among the $N$ given strings.\n\nHe has to answer the following for each given query :     \n\n\n1. Consider the set S described above. Compute the Longest Common Prefix (LCP) of each of the substring in this set with $A_X$. Find the **number of those substrings which have this LCP of length $\\geq Y$**.    \n2. Consider the **parent strings** for each of the substrings which satisfy the criteria in 1) mentioned above. **Among all such parent strings, find the lexicograhpically smallest one.** In the example mentioned above - Let's say **ab** and **bad** satisfy the criteria in 1), then lexicographically smallest among the parent strings **(abab, abad)** of these both  **(ab,bad)** will be **abab**.   If there are multiple lexicographically smallest parent strings, find the one with the **smallest index** and output this index.\n3. Consider the **parent strings** for each of the substrings which satisfy the criteria in 1) mentioned above. **Among all such parent strings, find the lexicograhpically largest one.** In the example mentioned above - Let's say **ab** and **bad** satisfy the criteria in 1), then lexicographically largest among the parent strings **(abab, abad)** of these both  **(ab,bad)** will be **abad**.   If there are multiple lexicographically largest parent strings, find the one with the **largest index**.\n\nHelp Jaime find the answer to all three of them for each of the query.     \n\n\n###Input:\n\n- First line will contain $N$, number of string.\n- $N$ lines follow, the i-th line containing $A_i$.  \n- Next line comprises $Q$ - the number of queries.  \n- $Q$ lines follow. Each line has 2 space separated integers  - $X$ and $Y$ as described above.\n\n###Output:\nFor each query, output three space separated integers as described above on a separate line.  \n**If for 2) and 3), there are no parent strings, print -1 for both 2) and 3) values.**\n\n###Constraints \n- Strings have lowercase characters ['a'-'z']\n- $1 \\leq N \\leq 10^5$\n- 1 $\\leq |A_i| \\leq 10^5$\n- Sum of length of all strings $\\leq 10^6$  \n- $1 \\leq Q \\leq 10^5$  \n- $1 \\leq X \\leq N$\n- $1 \\leq Y \\leq$ Sum of length of all strings\n\n###Sample Input:\n4  \nabad  \nabab  \nabab  \nabad  \n2  \n1 1  \n2 2  \n\n\n###Sample Output:\n6 2 4   \n4 2 4  \n\t\n###EXPLANATION:   \nFor 1st query, $A_1$ is **abad**. The substrings in set $S$ which have LCP>=1 with **abad** are **{a, ab, aba, abad, abab, ad}**.   \nThe parent strings of **a** = abad (index 1), abab (index 2), abab (index 3), abad (index 4).   \nThe parent strings of **ab** = abad (index 1), abab (index 2), abab (index 3), abad (index 4).     \nThe parent strings of **aba** = abad (index 1), abab (index 2), abab (index 3), abad (index 4).     \nThe parent strings of **abad** = abad (index 1), abad (index 4).    \nThe parent strings of **abab** = abab (index 2), abab (index 3).  \nThe parent strings of **ad** = abad (index 1), abad (index 4).      \nAmong all of these parent strings, **lexicographically smallest** are abab (index 2) and abab(index 3). The smallest of these indices is 2.     \nAmong all of these parent strings, **lexicographically largest** are abad (index 1) and abad(index 4). The largest of these indices is 4.     ","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, R, COB, FS","max_timelimit":"2.5","source_sizelimit":"50000","problem_author":"shivamg_isc","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>shivamg_isc<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"4-04-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/shivamg_isc'>shivamg_isc<\/a>","time":{"view_start_date":1554669000,"submit_start_date":1554669000,"visible_start_date":1554669000,"end_date":1735669800,"current":1559472981},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}