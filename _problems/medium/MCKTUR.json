{"category_name":"medium","status":"success","problem_code":"MCKTUR","problem_name":"Mock Turtle","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/mandarin\/MCKTUR.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/russian\/MCKTUR.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/vietnamese\/MCKTUR.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>\nThe Mock Turtle went to the ocean's school to become a true turtle! However instead of practicing the usual operations of addition, subtraction and division taught by the lecturers, she was always playing with parentheses.\n<\/p>\n\n<p>\nA parentheses is defined using the following rules:\n<ul>\n<li>An empty string is a parentheses.<\/li>\n<li>If <b>X<\/b> is a parentheses, then <b>(X)<\/b> is also a parentheses<\/li>\n<li>If <b>X<\/b> and <b>Y<\/b> are parentheses, then <b>XY<\/b> is also a parentheses<\/li>\n<li>Every parentheses can be created using the previous rules only.<\/li>\n<\/ul>\n<\/p>\n\n<p>\nA parentheses contains <b>k<\/b> blocks if it can be represented as the concatenation of exactly <b>k<\/b> non empty parentheses, but can not be represented as the concatenation of more than <b>k<\/b> non empty parentheses. For example <tt>()(())<\/tt> contains two blocks (i.e. <tt>()<\/tt> and <tt>(())<\/tt>) and <tt>(()())<\/tt> contains just one block.\n<\/p>\n\n<p>\nEvery time Alice meets with the Mock Turtle they create two arrays of integers <b>a<\/b> and <b>b<\/b> both of length <b>N<\/b>, and play the following game <b>T<\/b> times: <\/br>\n\nFirst Alice thinks of two integers <b>L<\/b> and <b>R<\/b>, then the Mock Turtle chooses two integers <b>i, j<\/b> such that <b>L \u2264 i, j \u2264 R<\/b> and builds all the parentheses of length <b>a<sub>i<\/sub><\/b> that contains <b>b<sub>j<\/sub><\/b> blocks. Since the Mock Turtle loves building parentheses, she will choose <b>i, j<\/b> in such a way that number of parentheses of length <b>a<sub>i<\/sub><\/b> that contains <b>b<sub>j<\/sub><\/b> blocks are maximized.<\/p>\n\n\n<h3>Input<\/h3>\n<p>The first line of the input contains two integers <b>N, T <\/b>.<\/p>\n<p>The following two lines containing <b>N<\/b> space separated integers representing the elements of array <b>a<\/b> and <b>b<\/b> respectively.<\/p>\n<p>Then follows <b>T<\/b> lines, each one have two integers <b>L<\/b> and <b>R<\/b> representing one game.<\/p>\n\n<h3>Output<\/h3>\n<p>For each game, output a single line containing the answer to the problem, since this number can be very large print it modulo <b>10<sup>9<\/sup>+7<\/b>.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>N, T<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>a<sub>i<\/sub>, b<sub>i<\/sub><\/b> \u2264 <b>2\u00b710<sup>5<\/sup>, a<sub>i<\/sub><\/b> is even<\/li>\n<li><b>1<\/b> \u2264 <b>L<\/b> \u2264 <b>R<\/b> \u2264 <b>N<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b><tt>\n5 2\n4 6 2 4 8\n3 3 3 3 3\n2 4\n1 5<\/tt>\n<b>Output:<\/b><tt>\n1\n3<\/tt>\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>In the <b>first query<\/b> the Mock Turtle can build only the parentheses <tt>()()()<\/tt><\/p>\n\n<p>In the <b>second query<\/b> the three possible parentheses are \n<ul>\n<li><tt>()()(())<\/tt><\/li>\n<li><tt>()(())()<\/tt><\/li>\n<li><tt>(())()()<\/tt><\/li>\n<\/ul>\n<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>alei<\/span>","problem_tester":"kingofnumbers","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>kingofnumbers<\/span>","date_added":"21-07-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>\n                    alei\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/catalan'>\n                    catalan\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>\n                    combinatorics\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/cook73'>\n                    cook73\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/MCKTUR","user":{"username":null},"time":{"view_start_date":1471804200,"submit_start_date":1471804200,"visible_start_date":1471804200,"end_date":1735669800,"current":1493557792},"todo":false,"problem_status":"unattempted"}