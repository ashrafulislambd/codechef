
{"category_name":"medium","status":"success","problem_code":"MATPER","problem_name":"Matchable Permutations","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/hindi\/MATPER.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/bengali\/MATPER.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/mandarin\/MATPER.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/russian\/MATPER.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/vietnamese\/MATPER.pdf) as well.\n\nChef has a string $S$ with length $N$. He also has $M$ other strings $P_1, P_2, \\ldots, P_M$, which are called *patterns*. The characters in the strings are indexed from $1$.\n\nChef was wondering if he could find the $M$ patterns in the string $S$ in the given order. That is, he wanted to know whether it is possible to choose $M$ ranges, denoted by $[l_i, r_i]$ for each $i$ ($1 \\le i \\le M$), such that $1 \\le l_1 \\le r_1 \\lt l_2 \\le r_2 \\lt \\ldots \\lt l_M \\le r_M \\le N$ and for each valid $i$, the substring $S_{l_i}, S_{l_i + 1}, \\ldots, S_{r_i}$ equals $P_i$.\n\nAs this problem was too easy for Chef, he decided to make a harder one. A permutation $p = (p_1, p_2, \\ldots, p_M)$ of integers $1$ through $M$ is called a *matchable permutation* if Chef can reorder the $M$ patterns into $P_{p_1}, P_{p_2}, \\ldots, P_{p_M}$ and then find them in $S$, in this order (in the same way as described above).\n\nCan you help Chef find the number of matchable permutations?\n\n### Input\n- The first line of the input contains two space-separated integers $N$ and $M$.\n- The second line contains a single string $S$.\n- $M$ lines follow. For each $i$ ($1 \\le i \\le M)$, the $i$-th of these lines contains a single string $P_i$. \n\n### Output\nPrint a single line containing one integer - the number of matchable permutations.\n\n### Constraints \n- $1 \\le N \\le 10^5$\n- $1 \\le M \\le 14$\n- $1 \\le |P_i| \\le 10^5$ for each valid $i$\n- $S, P_1, P_2, \\ldots, P_M$ contain only lowercase English letters\n\n### Subtasks\n**Subtask #1 (10 points):** $1 \\le M \\le 3$\n\n**Subtask #2 (30 points):** $1 \\le N \\le 1,000$\n\n**Subtask #3 (60 points):** original constraints\n\n### Example Input 1\n```\n10 3\nabbabacbac\nab\nac\nb\n```\n\n### Example Output 1\n```\n3\n```\n\n### Explanation 1\nAmong the $3! = 6$ possible permutations of $(1, 2, 3)$, the matchable permutations are $(1, 2, 3)$, $(3, 1, 2)$ and $(1, 3, 2)$. These correspond to permutations of patterns (\"ab\", \"ac\", \"b\"), (\"b\", \"ab\", \"ac\") and (\"ab\", \"b\", \"ac\") respectively. Each of them can be found in $S$ in the given order.\n\n### Example Input 2\n```\n3 2\naaa\naa\naa\n```\n\n### Example Output 2\n```\n0\n```\t\n\n### Explanation 2\nWe cannot match the two patterns in such a way that their ranges do not intersect.\n\n### Example Input 3\n```\n4 2\naaaa\naa\naa\n```\n\n### Example Output 3\n```\n2\n```\t\n\n### Explanation 3\nThe matchable permutations are $(1, 2)$ and $(2, 1)$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"2","source_sizelimit":"50000","problem_author":"triplem5ds","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>triplem5ds<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"26-02-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/kmp'>kmp<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march19'>march19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/meet-in-middle'>meet-in-middle<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/partial-sums'>partial-sums<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/triplem5ds'>triplem5ds<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MATPER","time":{"view_start_date":1552469402,"submit_start_date":1552469402,"visible_start_date":1552469402,"end_date":1735669800,"current":1559472977},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}