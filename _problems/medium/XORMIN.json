
{"category_name":"medium","status":"success","problem_code":"XORMIN","problem_name":"Mininum XOR over Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/hindi\/XORMIN.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/bengali\/XORMIN.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/mandarin\/XORMIN.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/russian\/XORMIN.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/vietnamese\/XORMIN.pdf) as well.\n\nYou are given a rooted tree with $N$ vertices (numbered $1$ through $N$); vertex $1$ is the root. Each vertex has a weight; let's denote the weight of vertex $i$ by $w_i$.\n\nYou should answer $Q$ queries. The queries have to be processed online, i.e. to obtain each query, you need the answer to the previous query.\n\nIn each query, you are given a vertex $v$ and a parameter $k$. For each vertex $u$ in the subtree of $v$ (including $v$), consider the value $w_u \\oplus k$ ($\\oplus$ denotes the bitwise XOR operation). The answer to this query is the maximum of these values and the smallest $u$ such that vertex $u$ is in the subtree of vertex $v$ and $w_u \\oplus k$ is equal to this maximum.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\n- The second line contains $N$ space-separated integers $w_1, w_2, \\ldots, w_N$.\n- Each of the next $N-1$ lines contains two space-separated integers $x$ and $y$ denoting that there is an edge between nodes $x$ and $y$.\n- The next $Q$ lines describe queries. Each of these lines contains two space-separated integers $a$ and $b$. The parameters $v$ and $k$ can be obtained in the following way: let's denote the value and vertex from the answer to the previous query by $x_l$ and $v_l$ respectively ($x_l = v_l = 0$ if this is the first query); then, $v = a \\oplus v_l$ and $k = b \\oplus x_l$.\n\n### Output\nFor each query, print a single line containing two space-separated integers \u2014 the answer to the query, i.e. the number of the vertex for which we get the maximum value and the maximum value.\n\n### Constraints \n- $1 \\le T \\le 1,000$\n- $1 \\le N \\le 2 \\cdot 10^5$\n- $1 \\le Q \\le 10^6$\n- $1 \\le x, y, v \\le N$\n- $1 \\le w_i \\lt 2^{20}$ for each valid $i$\n- $1 \\le k \\lt 2^{20}$\n- the sum of $N$ over all test cases does not exceed $2 \\cdot 10^5$\n- the sum of $Q$ over all test cases does not exceed $10^6$\n\n### Subtasks\n**Subtask #1 (10 points):**\n- the sum of $N$ over all test cases does not exceed $5,000$\n- the sum of $Q$ over all test cases does not exceed $5,000$\n\n**Subtask #2 (15 points):**\n- the sum of $N$ over all test cases does not exceed $2,000$\n- the sum of $Q$ over all test cases does not exceed $10^6$\n\n**Subtask #3 (75 points):** original constraints\n\n### Example Input\n```\n1\n10 5\n9 17 93 16 3 61 23 11 2 1\n1 2\n2 5\n5 8\n1 3\n1 4\n3 6\n3 7\n6 9\n6 10\n4 14\n7 123\n5 103\n9 32\n5 118\n```\n\n### Example Output\n```\n4 30\n7 114\n8 30\n3 99\n6 40\n```\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, R, COB, FS","max_timelimit":"2","source_sizelimit":"50000","problem_author":"evilbuggy","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>evilbuggy<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"12-03-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/april19'>april19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>data-structure<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/evilbuggy'>evilbuggy<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/trie'>trie<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/XORMIN","time":{"view_start_date":1555320602,"submit_start_date":1555320602,"visible_start_date":1555320602,"end_date":1735669800,"current":1559472987},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}