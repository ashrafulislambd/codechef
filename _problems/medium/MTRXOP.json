
{"category_name":"medium","status":"success","problem_code":"MTRXOP","problem_name":"Chef and Rotation","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/SNCKFL19\/hindi\/MTRXOP.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/SNCKFL19\/bengali\/MTRXOP.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/SNCKFL19\/mandarin\/MTRXOP.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/SNCKFL19\/russian\/MTRXOP.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/SNCKFL19\/vietnamese\/MTRXOP.pdf) as well.\n\nChef loves to play with matrices. One day in the kitchen, he found the following problem in his cookbook: You are given a matrix of integers with $3$ rows and $3$ columns (both rows and columns are numbered $1, 2, 3$) and a target matrix, also with $3$ rows and $3$ columns. You should transform the initial matrix into the target matrix by performing $N$ operations.\n\nEach operation is specified by parametres $A$, $X$, $D$, $S$ and corresponds to cyclically shifting a row or a column of the matrix. Valid operations must satisfy $1 \\le X \\le 3$ and $1 \\le A, D, S \\le 2$. There are four types of operations:\n- $A=1$ and $D=1$: shift row $X$ to the left, i.e. move the first element of this row to the end, $S$ times\n- $A=1$ and $D=2$: shift row $X$ to the right, i.e. move the last element of this row to the beginning, $S$ times\n- $A=2$ and $D=1$: shift column $X$ upwards, i.e. move the top element of this column to the bottom, $S$ times\n- $A=2$ and $D=2$: shift column $X$ downwards, i.e. move the bottom element of this row to the top, $S$ times\n\nFor example, applying an operation `1 2 1 2` on the matrix\n```\n7 7 7\n2 4 5\n7 7 7\n```\nresults in the matrix\n```\n7 7 7\n5 2 4\n7 7 7\n```\nbecause it means that left cyclic shift should be applied two times on the second row, so this row is transformed from `2 4 5` into `4 5 2` and then into `5 2 4`.\n\nApplying an operation `2 1 2 1` on the matrix\n```\n4 9 9\n2 9 9\n7 9 9\n```\nresults in the matrix\n```\n7 9 9\n4 9 9\n2 9 9\n```\nbecause it means that right cyclic shift should be applied once on the first column, so this column is transformed from `4 2 7` into `7 4 2`.\n\nIn this case, Chef has the initial matrix $M$, the target matrix $T$ and a sequence of only $N-1$ operations. He wants to insert one operation into this sequence (possibly at the beginning or at the end) without reordering the remaining operations. The resulting sequence of $N$ operations is applied on the matrix $M$, i.e. the first operation is applied on $M$, the second operation on the result of the first one and so on. Let's call the result of the last operation the *final matrix*.\n\nYou have to find the number of ways to insert an operation into the sequence such that the final matrix is the matrix $T$. Two ways to insert an operation are different if the operation is inserted at a different position or if it has a different $A$, $X$, $D$ or $S$.\n\n### Input\n- The first line of the input contains a single integer $N$.\n- $N-1$ lines follow. Each of these lines contains four space-separated integers $A$, $X$, $D$ and $S$ describing one operation.\n- The following three lines describe the initial matrix. For each $i$ ($1 \\le i \\le 3$), the $i$-th of these lines contains three space-separated integers $M_{i, 1}$, $M_{i, 2}$ and $M_{i, 3}$ denoting the elements of the $i$-th row of this matrix.\n- The following three lines describe the target matrix. For each $i$ ($1 \\le i \\le 3$), the $i$-th of these lines contains three space-separated integers $T_{i, 1}$, $T_{i, 2}$ and $T_{i, 3}$ denoting the elements of the $i$-th row of this matrix.\n\n### Output\nPrint a single line containing one integer \u2014 the number of valid ways to insert an operation.\n\n### Constraints\n- $1 \\le N \\le 20,000$\n- $1 \\le M_{i, j}, T_{i, j} \\le 9$ for each valid $i, j$\n- $1 \\le X \\le 3$\n- $1 \\le A, D, S \\le 2$\n\n### Example Input 1\n```\n2\n1 3 1 1\n1 1 1\n1 1 1\n1 1 1\n1 1 1\n1 1 1\n1 1 1\n```\n\n### Example Output 1\n```\n48\n```\n\n### Explanation \nYou can insert any operation at any position, that is, either before or after the only given operation.\n\n### Example Input 2 \n```\n2\n1 3 1 1\n1 1 1\n1 1 1\n1 1 1\n1 1 1\n1 1 1\n1 1 2\n```\n\n### Example Output 2\n```\n0 \n```\n\n### Explanation \nThere is no valid way to insert an operation, since it is impossible to obtain the target matrix.\n\n### Example Input 3\n```\n1\n1 2 3\n4 5 6\n7 8 9\n1 2 9\n4 5 3\n7 8 6\n```\n\n### Example Output 3\n```\n2\n```\n\n### Explanation \nThe sequence of $N-1$ operations is empty, so there is only one position in which one operation can be inserted. The two operations that can be used to obtain the target matrix from the initial matrix are `2 3 1 2` and `2 3 2 1`.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"vipsharmavip","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>vipsharmavip<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"8-02-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/implementation'>implementation<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/snckfl19'>snckfl19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vipsharmavip'>vipsharmavip<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MTRXOP","time":{"view_start_date":1550311200,"submit_start_date":1550311200,"visible_start_date":1550311200,"end_date":1735669800,"current":1559472978},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}