{"category_name":"medium","status":"success","problem_code":"GPD","problem_name":"Gotham PD","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MAY17\/mandarin\/GDP.pdf\">mandarin chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MAY17\/russian\/GDP.pdf\">russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/MAY17\/vietnamese\/GDP.pdf\">vietnamese<\/a> as well.<\/h3>\n\n\n<p>Chef has teamed up with Batman and Jim Gordon to save Gotham from Joker's plan.<p>\n\n<p>\nThere are initially <b>N<\/b> police stations each having a unique id and an encryption key.\nAll stations are connected, using telephone lines, directly or indirectly, to Gordon's police station \n(the one with id <b>R<\/b>).\nIn order to provide better protection for all people in Gotham, Batman and Chef have paid for some \nnew police stations and come up a smart algorithm to test the security of a particular police station. \n<\/p>\n\n<p>There are <b>Q<\/b> queries that the two of them perform on Gotham's infrastructure each being either an addition of a new police station or \na security test, on a particular station, using a key generated by Chef.<\/p>\n\n<p>\nYour task is to help our three heroes to perform all the queries succesfully and defeat Joker.\n<\/p>\n\n<h3>Input<\/h3>\n<p>There is only one test case in each test file.<\/p>\n<p>The first line contains two numbers, <b>N<\/b> and <b>Q<\/b>, denoting  the number of police stations and \n       the number of queries respectively.<\/p>\n<p>The second line contains two numbers, <b>R<\/b> and <b>key<\/b>, denoting the main station's id and \n       its encryption key. <\/p>\n<p>Each of the next <b>N-1<\/b> lines contains three numbers: <b>u<\/b>, <b>v<\/b>, <b>k<\/b> which represent that there is a \n       telephone line from <b>v<\/b> to <b>u<\/b> and that <b>u<\/b>'s encryption key is <b>k<\/b>.<\/p>\n<p>Each of the next <b>Q<\/b> lines contains a query of form:\n<ul>\n<li> <b>0 v u k<\/b>: A new station with id <b>u<\/b> and encryption key <b>k<\/b> is added and connected by \n                a telephone line to <b>v<\/b> <\/li>\n<li> <b>1 v k<\/b>: The security test needs two encryption keys <b>a<\/b> and <b>b<\/b> such that <b>a<\/b> minimizes the value of <b>a xor k<\/b> and <b>b<\/b> that\n               maximizes the value of <b>b xor k<\/b>. <b>a<\/b> and <b>b<\/b> are encryption keys that correspond to some nodes that lie on the path, formed by telephone lines,\n               from police station <b>v<\/b> to Gordon's police station, <b>R<\/b>.<\/li>\n<\/ul>\n<\/p>\n\n<p> The problem requires an <b>online solution<\/b>. Each query will be encoded using the xor between its real values and the value of the last answer. Please see the note section at the end of the statement to see a piece of code that\nshows how the input should be read.<\/p>\n\n<h3>Output<\/h3>\n<p>For each operation of type 1, output a single line containing the two requested values (min-value and max-value) separated by a single space.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>N<\/b> \u2264 100,000<\/li>\n<li>1 \u2264 <b>Q<\/b> \u2264 200,000<\/li>\n<li>1 \u2264 <b>R, u<sub>i<\/sub>, v<sub>i<\/sub>, key, k<sub>i<\/sub><\/b> \u2264 <b>2<sup>31<\/sup>\u2212 1<\/b><\/li>\n<li>All ids are <b>unique<\/b> (there aren't at any time two police stations with the same id).<\/li>\n<li>Whenever you have to connect a node <b>u<\/b> to another one <b>v<\/b>, it is <b>guaranteed<\/b> that <b>v<\/b> is <b>already connected<\/b>, directly of indirectly, to <b>R<\/b>.\n<\/ul>\n\n<h3>Subtasks<\/h3>\n<b>Subtask #1 (30 points):<\/b>\n<ul>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>5000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>Q<\/b> \u2264 <b>5000<\/b><\/li>\n<\/ul>\n<br>\n<b>Subtask #2 (70 points):<\/b>\n<ul>\n<li>Original constraints<\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n6 4\n1 2\n5 1 3\n2 1 4\n3 2 5\n4 2 1\n6 3 3\n1 4 2\n6 0 12 0\n7 12 7\n4 0 7\n\n\n<b>Output:<\/b>\n0 6\n2 7\n0 1\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>\nInitially, there are 6 police stations in Gotham and our heroes have 4 operations to perform\nGordon's station is the one that has id 1 and key 2.<\/p>\n\n<p><b>First query: <\/b> The values on the path from <b>4<\/b> to <b>1<\/b> are <b>1 xor 2 = 3<\/b>, <b>4 xor 2 = 6<\/b> and <b>2 xor 2 = 0<\/b>. The answer is <b>0 6<\/b>.<\/p>\n<p><b>Second query: <\/b> The values on the path from <b>10<\/b> to <b>1<\/b> are <b>6 xor 1 = 7<\/b>, <b>3 xor 1 = 2<\/b>, <b>5 xor 1 = 4<\/b>, <b>4 xor 1 = 5<\/b> and <b>2 xor 1 = 3<\/b>. The answer is <b>2 7<\/b>.<\/p>\n<p><b>Third query: <\/b> The values on the path from <b>5<\/b> to <b>1<\/b> are <b>3 xor 2 = 1<\/b> and <b>2 xor 2 = 0<\/b>. The answer is <b>0 1<\/b>.<\/p>\n\nThe decoded version of all operations is:\n<pre>\n1 4 2    (t v k)\n0 6 10 6 (t v u k)\n1 10 1   (t v k)\n1 5 2    (t v k)\n<\/pre>\n\n<h3>Note<\/h3>\n\n<pre><code class=\"language-c++\">\ncin >> N >> Q;\ncin >> R >> key;\n\nfor (i = 0; i < N - 1; i++)\n{\n    cin >> u >> v >> k;\n}\n\nint last_answer = 0;\n\nfor (i = 0; i < Q; i++)\n{\n    cin >> t;\n    \n    \/\/ find real value of t\n    t ^= last_answer;\n\n    if (t == 0)\n    {\n        cin >> v >> u >> k;\n        \n        \/\/ find real values for u, v, and k\n        u ^= last_answer;\n        v ^= last_answer;\n        k ^= last_answer;\n    }\n    else\n    {\n        cin >> v >> k;\n\n        \/\/ find real values for v, and k\n        v ^= last_answer;\n        k ^= last_answer;\n        \n        \/\/ compute the requested values\n        int min_answer = ...\n        int max_answer = ...\n\n        \/\/ update last_answer\n        last_answer = min_answer ^ max_answer;  \n    }\n}\n<\/code><\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2","source_sizelimit":"50000","problem_author":"alexvaleanu","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>alexvaleanu<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"4-05-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alexvaleanu'>\n                    alexvaleanu\n                <\/a>","user":{"username":null},"time":{"view_start_date":1495099800,"submit_start_date":1495099800,"visible_start_date":1495099800,"end_date":1735669800,"current":1497284434},"todo":false,"problem_status":"unattempted"}