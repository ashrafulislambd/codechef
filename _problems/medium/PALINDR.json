{"category_name":"medium","status":"success","problem_code":"PALINDR","problem_name":"Lucy and Palindromes","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in Russian <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME06\/russian\/PALINDR.pdf\">here<\/a><\/h3>\n<p>Lucy had recently learnt about palindromes. As you may probably know, palindrome is a string that reads the same way in the both directions, that is left-to-right or right-to-left. For example, strings \"radar\" and \"level\" are palindromes, at the same time, strings \"hello\" and \"world\" are not.<\/p>\n<p>There is a string of <b>N<\/b> latin letters. Lucy asks you to answer the following queries:<br \/><br \/>\n1 <b>L<\/b> <b>R<\/b> - reverse the substring from the <b>L<\/b>-th to the <b>R<\/b>-th character (1-indexed), inclusive.<br \/><br \/>\n2 <b>L<\/b> <b>R<\/b> - calculate the number of distinct palindromes that can be obtained by permutting characters from the <b>L<\/b>-th to the <b>R<\/b>-th in the arbitrary order (ignoring all other characters of the string).<br \/><\/p>\n<h3>Input<\/h3>\n<p>The first line of input consists of two space separated integers <b>N<\/b> and <b>M<\/b> - the length of the string and the number of queries.<br \/>\nThe second line consists of <b>N<\/b> characters from the set {'<b>a<\/b>', '<b>b<\/b>', '<b>c<\/b>', '<b>d<\/b>', '<b>e<\/b>', '<b>f<\/b>', '<b>g<\/b>', '<b>h<\/b>', '<b>i<\/b>', '<b>j<\/b>'}, describing the string. Then, <b>M<\/b> queries follow. Each query is given in one of the following forms:<br \/><br \/>\n1 <b>L<\/b> <b>R<\/b> - reverse the substring from the <b>L<\/b>-th to the <b>R<\/b>-th character.<br \/><br \/>\n2 <b>L<\/b> <b>R<\/b> - calculate the number of distinct palindromes that can be obtained by permutting characters from the <b>L<\/b>-th to the <b>R<\/b>-th in the arbitrary order, modulo <b>10<sup>9<\/sup>+7<\/b> (ignoring all other characters).<\/p>\n<h3>Output<\/h3>\n<p>For every query of the type <b>2<\/b> output the answer on the separate line.<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n7 4\nabacaba\n2 1 7\n2 2 3\n1 1 2\n2 2 3\n\n<b>Output:<\/b>\n3\n0\n1\n<\/pre><h3>Scoring<\/h3>\n<p>In all the subtasks, 1 &lt;= <b>L<\/b> &lt;= <b>R<\/b> &lt;= <b>N<\/b>.<br \/><br \/>\nSubtask 1 (33 points): 1 &lt;= <b>N<\/b> &lt;= 10, 1 &lt;= <b>M<\/b> &lt;= 1000<br \/><br \/>\nSubtask 2 (17 points): 1 &lt;= <b>N<\/b> &lt;= 1000, 1 &lt;= <b>M<\/b> &lt;= 1000<br \/><br \/>\nSubtask 3 (23 points): 1 &lt;= <b>N<\/b> &lt;= 4*10<sup>4<\/sup>, 1 &lt;= <b>M<\/b> &lt;= 4*10<sup>4<\/sup><br \/><br \/>\nSubtask 4 (27 points): 1 &lt;= <b>N<\/b> &lt;= 10<sup>5<\/sup>, 1 &lt;= <b>M<\/b> &lt;= 10<sup>5<\/sup><br \/><br \/>\nTime limit for subtasks 1 and 2 is 1 sec, and for the subtasks 3 and 4 it's equal to 2 sec.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1 - 2","source_sizelimit":"50000","problem_author":"xcwgf666","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","problem_tester":"Rubanenko","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>rubanenko<\/span>","date_added":"14-10-2013","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>\n                    combinatorics\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>\n                    easy-medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ltime06'>\n                    ltime06\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/treap'>\n                    treap\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/xcwgf666'>\n                    xcwgf666\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/PALINDR","user":{"username":null},"time":{"view_start_date":1385283849,"submit_start_date":1385283849,"visible_start_date":1385283849,"end_date":1735669800,"current":1493557837},"todo":false,"problem_status":"unattempted"}