{"category_name":"medium","status":"success","problem_code":"SEQLCS","problem_name":"Chef and the Number Sequence","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK61\/mandarin\/SEQLCS.pdf\">Mandarin Chinese<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK61\/russian\/SEQLCS.pdf\">Russian<\/a> as well.<\/h3>\n<p>Chef has a sequence <b>A<\/b> consisting of <b>N<\/b> integers each lying between <b>1<\/b> and <b>K<\/b>, both inclusive. Now he wants to construct another sequence <b>B<\/b> of the same length also containing integers between <b>1<\/b> and <b>K<\/b> (again, both inclusive). Find out in how many ways he can construct the sequence <b>B<\/b>, such that the length of <a href=\"https:\/\/en.wikipedia.org\/wiki\/Longest_common_subsequence_problem\">Longest Common Subsequence (LCS)<\/a>  of <b>A<\/b> and <b>B<\/b> is exactly <b>L<\/b>. As the answer could be large, print it modulo <b>10<sup>9<\/sup> + 7<\/b>.\n<\/p>\n<h3>Input<\/h3>\n<p>The first line of the input contains <b>T<\/b> denoting the number of test cases. Each test case contains two lines: <\/p>\n<ul>\n<li>The first line of each test case contains three space separated integers <b>N<\/b>, <b>K<\/b>, and <b>L<\/b>.<\/li>\n<li>The second line contains <b>N<\/b> space separated integers <b>A<sub>1<\/sub><\/b>, <b>A<sub>2<\/sub><\/b>, ... <b>A<sub>N<\/sub><\/b>. <\/li>\n<\/ul>\n<h3>Output<\/h3>\n<p>For each test case output the number of ways to construct B as described above. Output the result modulo <b>10<sup>9<\/sup> + 7<\/b>.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>N,K<\/b> \u2264 <b>16<\/b> <\/li>\n<li><b>1<\/b> \u2264 <b>L<\/b> \u2264 <b>N<\/b> <\/li>\n<li>The sequence <b>A<\/b> consists of integers between <b>1<\/b> and <b>K<\/b> (both inclusive). <\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n2 2 1\n1 2\n3 3 2\n1 2 2\n\n<b>Output:<\/b>\n3\n11\n\n<\/pre><h3>Explanation<\/h3>\n<p>\n<b>First Example<\/b> : There are total three possible valid sequences <b>B<\/b> : [1, 1], [2, 2] and [2, 1]. LCS of these sequences with sequence <b>A<\/b> is equal to 1. Note that [1, 2] is not a valid sequence as LCS of this and sequence <b>A<\/b> is equal to 2.\n<\/p>\n<p>\n<b>Second Example<\/b>: The 11 ways are: [1, 1, 2], [1, 2, 1], [1, 2, 3],  [1, 3, 2], [2, 1, 2], [2, 2, 1],  [2, 2, 2], [2, 2, 3], [2, 3, 2],  [3, 1, 2], [3, 2, 2].\n<\/p>\n<h3>Note<\/h3>\n<p>Two sequences of <b>B<\/b> are considered different if there is at least one position which contains different numbers in the sequences.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"4","source_sizelimit":"50000","problem_author":"rustinpiece","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #1E7D22;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>2&#9733;<\/span><span>rustinpiece<\/span>","problem_tester":"iscsi","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>iscsi<\/span>","date_added":"1-08-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook61'>\n                    cook61\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dp+bitmask'>\n                    dp+bitmask\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/rustinpiece'>\n                    rustinpiece\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/SEQLCS","user":{"username":null},"time":{"view_start_date":1440357600,"submit_start_date":1440357600,"visible_start_date":1440357600,"end_date":1735669800,"current":1493557974},"todo":false,"problem_status":"unattempted"}