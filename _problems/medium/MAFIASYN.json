
{"category_name":"medium","status":"success","problem_code":"MAFIASYN","problem_name":"Mafia Syndicate","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>There is a tree with $N$ nodes, numbered from 1 to $N$. The tree is rooted at node 1. The tree represents the structure of a big mafia syndicate, and\neach node represents a criminal. Each criminal, except the leader (who is denoted by node 1), is\nunder the supervision of his boss, who is his parent in the tree.\n\nInitially, each criminal\/node except the leader has some money. Starting now, at every second, each criminal will pass on all the money that he has, to his boss (i.e. parent). And during the same second, his 'children' might have passed on some amount to him, which he will pass on to his parent in the next second, and so on.\n\nHowever, a criminal might go rogue if the money he has strictly exceeds some threshold (that is, if the money that he has is greater than a particular value, he is overpowered by greed). Going rogue means, at some point, if the amount of money that he has to pass on to his boss is greater than the threshold, he won't do so, and instead keep the amount to himself. And after this, all the money that comes to him, he will keep to himself. He will not pass on anything after this.\n\nSo, as an example if there is a tree, 1 - 2 - 3, in which 1 is the root, 2 is beneath 1, and 3 is beneath 2. And suppose the amount of money that each of the criminals initially have is (Note that the root node will not have anything in the beginning):\n\n$have[1] = 0$\n\n$have[2] = 10$\n\n$have[3] = 100$\n\nAnd their thresholds are:\n\n$cap[2] = 10$\n\n$cap[3] = 1000$\n\nThat is, if at any second, node 2 has strictly more than 10 amount of money, then he will turn rogue, and will stop passing the money to his boss.\n\n\nNow, at the first second, no criminal has more money than his threshold. So, both criminals 2 and 3 pass on their money to their bosses. Thus, after the first second, the criminals will have the following:\n\n\n$have[1] = 10$\n\n$have[2] = 100$\n\n$have[3] = 0$\n\nBut now, since $have[2] \\gt cap[2]$, criminal 2 turns rogue, and won't pass on any money to his boss anymore. Nothing changes after this, and so this is the stable state.\n\nYou can show that after some finite amount of time, the configuration remains constant, with no more passing of money. We call this the stable state. The problem is, given the tree with $N$ nodes, and two arrays $have[2], have[3], \\ldots, have[N]$ and $cap[2], cap[3], \\ldots, cap[N]$ of size $N - 1$, find out the total money which the leader (ie. root node) will have at the end, in the stable state.\n\n###Input\n\n- The first line contains the integer $N$, denoting the number of criminals\/nodes in the syndicate\/tree.\n- The $i^{th}$ of the next $N - 1$ lines contains two space separated integers, $have[i+1]$ and $cap[i+1]$, which correspond to the amount that criminal $i+1$ initally has, and the threshold beyond which he will turn rogue. Note that $have[1]$ is 0 and $cap[1]$ is irrelevant, so they are not provided in the input.\n- The $i^{th}$ of the next $N - 1$ lines contains a single integer, denoting the immediate boss of the $(i+1)^{th}$ criminal. Note that criminal $1$ (i.e. the leader) has no immediate boss, and hence is not included in this input.\n\n###Output\n\nPrint the total amount present at the root node at the end, in the stable state.\n\n###Constraints\n\n- $1 \\le N \\le 10^5$\n- $0 \\le have[i] \\le cap[i] \\le 10^9$\n\n\n###Example Input 1\n```\n3\n10 10\n100 1000\n1\n2\n```\n\n###Example Output 2\n```\n10\n```\n\n###Explanation 1\nAs explained above, the root will get the money from criminal 2 at the first second, but nothing after that. Hence the answer is 10.\n\n###Example Input 2\n\n```\n6\n10 10\n1 2\n10 10\n1 2\n10 10\n1\n1\n2\n3\n2\n```\n\n###Example Output 2\n\n```\n12\n```\n\n###Explanation 2\nIn the figures below, the first integer in each node corresponds to its number, and the second integer corresponds to the amount held by that criminal at that moment.\n\nThe original configuration is \n\n![Initial](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/TST18KGP\/MAFIASYN\/1.png =275x275)\n\nDuring the first second, every criminal (except the leader) passes on the amount that they hold to their boss. So, after the first second, it changes to:\n\n![After first second](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/TST18KGP\/MAFIASYN\/2.png =275x275)\n\nDuring the second second, criminal 2 turns rogue, because 20 > 10. So he stops passing any amount. But criminal 3 doesn't turn rogue, because 1 <= 2. And so he passes on the amount of 1 to his boss. So, after the second second, it changes to:\n\n![After second second](https:\/\/codechef_shared.s3.amazonaws.com\/download\/Images\/TST18KGP\/MAFIASYN\/3.png =275x275)\n\nAfter this, it does not change, and hence the answer is 12.","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"bk2dcradle","problem_author_html_handle":"bk2dcradle","problem_tester":null,"problem_tester_html_handle":"","date_added":"10-12-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/bk2dcradle'>bk2dcradle<\/a>","time":{"view_start_date":1544985000,"submit_start_date":1544985000,"visible_start_date":1544985000,"end_date":1735669800,"current":1559472975},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}