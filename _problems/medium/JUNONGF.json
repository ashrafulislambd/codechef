{"category_name":"medium","status":"success","problem_code":"JUNONGF","problem_name":"Juno Puzzle for May","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3><b>Problem description<\/b><\/h3>\n\n<p>Chef Juno's girlfriend, May, is a programmer and a mathematician, and she loves solving problems. Everyday Chef Juno comes up with new problems for her to solve, otherwise she gets bored and depressed. He doesn't want her to feel so, but he has run out of all problems. He consults his Chef friends, who came up with a new problem.<\/p>\n<p>The Chef City is an <b>N<\/b>-dimensional city of dimensions L[0]*..*L[N-1] and each of the (L[0]*..*L[N-1]) cells may have 0 to <b>V<\/b>-1 restaurants. They want to know the number of ways they can open restaurants in each cell of the city such that the sum of the number of restaurants in every sub-block(see details) in Chef City is divisible by <b>V<\/b>.<\/p>\n<p>Chef Juno realizes that this number could be very huge given the size of Chef City, so to make this problem a little easier for his girlfriend (and for himself, as he should himself know the solution ;)), he wants the answer modulo 1000000007. But before asking her this problem, he wants to know the answer himself. So he turns to you for help. Please help him :)\n<\/p>\n<p><b>Details<\/b><\/p>\n<p>A sub-block of an N-dimensional hyperrectangle can be defined as an N-dimensional hyperrectangle of<br \/>\n1*1*..L[i]..*1*1 dimensions for i ranging from 0 to N-1, where the ith dimension is L[i].<br \/>\nFor example, in a 2*3*2 cuboid, we can have sub-blocks of<br \/>\n2*1*1, 1*3*1 and 1*1*2 dimensions and each of the 12 cells can have<br \/>\n0 to V-1 restaurants in such a way that the sum of the number of restaurants in every sub-block is divisible by V.<\/p>\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of T test cases follows.<\/p>\n<p>The first line of each test case contains two space-separated integers <b>V<\/b> and <b>N<\/b>.<\/p>\n<p>Since the input file size may go large, we ask you to generate the input using the following scheme.<br \/><br \/>\nYou have two lines of 6 integers each.<br \/><br \/>\nThe first line consists of the integers <b>P[0], P[1], A0, B0, C0, M0<\/b>.<br \/><br \/>\nThe second line consists of the integers <b>Q[0], Q[1], A1, B1, C1, M1<\/b>.<\/p>\n<p>Using the above, you can generate arrays P[] and Q[] as follows:<br \/><br \/>\nP[i] = A0 * A0 * P[i-1] + B0 * P[i-2] + C0 modulo (M0)<br \/><br \/>\nQ[i] = A1 * A1 * Q[i-1] + B1 * Q[i-2] + C1 modulo (M1)<br \/><br \/>\nfor i>=2 and i &lt; N<\/p>\n<p>From this, the ith dimension can be calculated as follows: <br \/><br \/>\nThe ith dimension, L[i] = P[i]*(M1)+Q[i]+1 for i>=0 and i &lt; N<\/p>\n<h3>Output<\/h3>\n<p>For each test case, output a single line containing the answer. As was mentioned above, you should print this number modulo 1000000007.<\/p>\n<h3>Constraints<\/h3>\n\n<p>1 &lt;= T &lt;= 100000<\/p>\n<p>2 &lt;= N &lt;= 100<\/p>\n<p>1 &lt;= V &lt;= 2^63 - 1<\/p>\n<p>0&lt;=A[0],A[1],B[0],B[1],C[0],C[1]&lt;=100000<\/p>\n<p>0 &lt;= P[0], P[1] &lt; max(10^5+1, M0)<br \/>\nand<\/p>\n<p>0 &lt;= Q[0], Q[1] &lt; max(10^5+1, M1)<\/p>\n<p>1&lt;=M0 and M1&lt;=2^31-1<\/p>\n<p>All N dimensions after calculation will be between 1 and 2^63 \u2013 1.<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n<p><\/p>\n3\n1 2\n1 1 1 1 1 1\n1 1 1 1 1 1\n3 2\n1 1 1 1 1 2\n2 1 1 1 1 1\n3 3\n1 1 1 1 1 2\n1 1 0 0 0 2\n<b>Output:<\/b>\n1\n729\n387420489\n<\/pre><h3>Explanation<\/h3>\n<p><b>Test case 1<\/b>: Since V is equal to 1, there is only way to open restaurants in the 2 dimensional city of dimensions 3*3:<\/p>\n<p>| 0 0 0 |<\/p>\n<p>| 0 0 0 |<\/p>\n<p>| 0 0 0 |<\/p>\n<p>Here the sum of the number of restaurants opened in every sub-block of dimensions 1*3 and 3*1<br \/>\n is divisible by 1.\n<\/p>\n<p>\n<b>Test case 2<\/b>: Here the dimensions of the city are 4*3 and V=3.<br \/>\nSo one of the ways to open restaurants in each cell of the<br \/>\ncity is:<\/p>\n<p>|1 0 2|<\/p>\n<p>|2 1 0|<\/p>\n<p>|1 2 0|<\/p>\n<p>|2 0 1|<\/p>\n<p>Here the sum of the number of restaurants opened in every sub-block of dimensions 1*3 and 4*1<br \/>\nis divisible by V=3.\n<\/p>\n<p>\n<b>Test case 3<\/b>: Here we are given a 3-dimensional hyperrectangle<br \/>\nof dimensions 4*4*3 and V is 3.<br \/>\nSo in each of the 48 cells, we can open 0 to 2 restaurants, but we have to ensure that sum of the number of restaurants in every 4*1*1 sub-block, 1*4*1 sub-block and 1*1*3 sub-block is divisible by 3.\n<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, WSPC","max_timelimit":"2","source_sizelimit":"50000","problem_author":"mischievous_me","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>mischievous_me<\/span>","problem_tester":"pieguy","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>pieguy<\/span>","date_added":"21-03-2013","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/exponentiation'>\n                    exponentiation\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/may13'>\n                    may13\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/mischievous_me'>\n                    mischievous_me\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/number-theory'>\n                    number-theory\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/simple-math'>\n                    simple-math\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/JUNONGF","user":{"username":null},"time":{"view_start_date":1368441000,"submit_start_date":1368441000,"visible_start_date":1368441000,"end_date":1735669800,"current":1493557702},"todo":false,"problem_status":"unattempted"}