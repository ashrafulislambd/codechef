
{"category_name":"medium","status":"success","problem_code":"EDGY","problem_name":"Edgy","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/hindi\/EDGY.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/bengali\/EDGY.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/mandarin\/EDGY.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/russian\/EDGY.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/APRIL19\/vietnamese\/EDGY.pdf) as well.\n\nYou are given a tree with $N$ vertices (numbered $1$ through $N$). Each edge of this tree is coloured either black or white.\n\nA *single-colour subtree* of this tree is a non-empty maximal set $S$ of its edges such that all edges in $S$ have the same colour and each of these edges can be reached from any other edge in $S$ by only traversing edges from $S$. A maximal set is a set to which we cannot add any edge without breaking this property.\n\nYou should process $Q$ queries. In each query, you are given two vertices $u$ and $v$. Flip the colour of each edge on the path between $u$ and $v$ (black edges become white and white edges become black) and then compute the number of single-colour subtrees of the tree. The colours of the edges remain flipped in the subsequent queries.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains a single integer $N$.\n- Each of the next $N-1$ lines contains three space-separated integers $a$, $b$ and $c$ denoting that there is an edge between vertices $a$ and $b$ with colour $c$; a black edge is denoted by $c = 0$ and a white edge by $c = 1$.\n- The next line contains a single integer $Q$.\n- The following $Q$ lines describe queries. Each of these lines contains two space-separated integers $u$ and $v$.\n\n### Output\nFor each query, print a single line containing one integer \u2014 the number of single-colour subtrees.\n\n### Constraints \n- $1 \\le T \\le 100$\n- $1 \\le N, Q \\le 10^5$\n- $1 \\le a, b, u, v \\le N$\n- $0 \\le c \\le 1$\n- the graph described on the input is a tree\n- the sum of $N$ over all test cases does not exceed $3 \\cdot 10^5$\n- the sum of $Q$ over all test cases does not exceed $3 \\cdot 10^5$\n\n### Subtasks\n**Subtask #1 (100 points):** original constraints\n\n### Example Input\n```\n2\n4\n1 2 0\n2 3 0\n3 4 1\n3\n2 3\n1 4\n3 4\n7\n1 2 0\n2 3 0\n5 4 1\n4 3 1\n6 3 0\n7 6 0\n2\n2 6\n5 3\n```\n\n### Example Output\n```\n2\n2\n3\n3\n4\n```\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, R, COB, FS","max_timelimit":"5","source_sizelimit":"50000","problem_author":"watcher","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>watcher<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"27-03-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/april19'>april19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/coloring'>coloring<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/hard'>hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/heavy-light'>heavy-light<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tree'>tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/watcher'>watcher<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/EDGY","time":{"view_start_date":1555320602,"submit_start_date":1555320602,"visible_start_date":1555320602,"end_date":1735669800,"current":1559472973},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}