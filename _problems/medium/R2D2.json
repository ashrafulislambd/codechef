
{"category_name":"medium","status":"success","problem_code":"R2D2","problem_name":"The Last Droid","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/LTIME71\/hindi\/R2D2.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/LTIME71\/bengali\/R2D2.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/LTIME71\/mandarin\/R2D2.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/LTIME71\/russian\/R2D2.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/LTIME71\/vietnamese\/R2D2.pdf) as well.\n\nThe droid R2-D2 is travelling in space with a special mission. In space, there are $N$ planets (numbered $1$ through $N$) and $M$ bidirectional space highways. Each space highway connects two planets and in order to use it, R2-D2 needs to have a sufficiently high *status level*.\n\nThe droid\u2019s mission consists of $Q$ stages. In each stage, there are two planets $x$ and $y$ such that the droid should start the stage at planet $x$ with some initial status level $L$ ($L \\ge 0$) and travel to planet $y$. For each valid $i$, when R2-D2 is at planet $i$ (including the initial planet $x$), he may increase his status level by $A_i$; it is not allowed to increase the status level multiple times on the same planet in the same stage. Find the minimum value of $L$ such that it is possible for R2-D2 to reach planet $y$ or determine that it is impossible to reach planet $y$ for any $L$.\n\nNote that the level R2-D2 has at the end of each stage is not carried over to the next stages (he may start the next stage with a lower initial status level).\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $M$.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\n- Each of the following $M$ lines contains three space separated integers $U$, $V$ and $W$ denoting that there is a space highway between planets $U$ and $V$ and R2-D2 may use this highway only if his status level is at least $W$.\n- The next line contains a single integer $Q$.\n- The following $Q$ lines describe stages. Each of these lines contains two space-separated integers $x$ and $y$.\n\n### Output\nFor each stage, print a single line containing one integer \u2015 the minimum status level required to complete the stage, or $-1$ if it is impossible to complete this stage.\n\n### Constraints \n- $1 \\le T \\le 100$\n- $1 \\le N, M, Q \\le 10^5$\n- $0 \\le A_i \\le 10^9$ for each valid $i$\n- $0 \\le W \\le 10^9$\n- $1 \\le U, V, x, y \\le N$\n- the sum of $N$ over all test cases does not exceed $400,000$\n- the sum of $M$ over all test cases does not exceed $400,000$\n- the sum of $Q$ over all test cases does not exceed $400,000$\n\n### Subtasks\n**Subtask #1 (12 points):**\n- $N, Q \\le 1,000$\n- $M \\le 1,200$\n- the sum of $N$ over all test cases does not exceed $4,000$\n- the sum of $M$ over all test cases does not exceed $4,000$\n- the sum of $Q$ over all test cases does not exceed $4,000$\n\n**Subtask #2 (28 points):** $A_i = 0$ for each valid $i$\n\n**Subtask #3 (60 points):** original constraints\n\n### Example Input\n```\n1\n6 5\n1 3 1 2 0 0\n1 2 4\n1 3 2\n1 4 3\n3 4 5\n3 5 7\n4\n2 2\n1 5\n5 1\n3 6\n```\n\n### Example Output\n```\n0\n1\n7\n-1\n```\n\n### Explanation\nIn the second stage, R2-D2 can travel through planets $1 \\rightarrow 3 \\rightarrow 1 \\rightarrow 4 \\rightarrow 1 \\rightarrow 2 \\rightarrow 1 \\rightarrow 3 \\rightarrow 5$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, R, COB, FS","max_timelimit":"4","source_sizelimit":"50000","problem_author":"farhod_farmon","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>farhod_farmon<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"25-04-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/disjoint-set'>disjoint-set<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/farhod_farmon'>farhod_farmon<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime71'>ltime71<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/sorting'>sorting<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tree-based'>tree-based<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/R2D2","time":{"view_start_date":1556384402,"submit_start_date":1556384402,"visible_start_date":1556384402,"end_date":1735669800,"current":1559472981},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}