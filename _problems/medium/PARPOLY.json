{"category_name":"medium","status":"success","problem_code":"PARPOLY","problem_name":"Polynomial Partition Function","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>\nChef Ciel is participating in an arithmetic contest now.\nWhy?\nBecause of the top prize for the contest, a limited edition kitchen knife.\n<\/p>\n\n<p>\nBut to win the contest she must calculate the values <strong>f<\/strong>(<strong>M<\/strong>, <strong>N<\/strong>, <strong>X<\/strong>) of the function named <i>polynomial partition function<\/i>.\nThe polynomial partition function <strong>f<\/strong>(<strong>M<\/strong>, <strong>N<\/strong>, <strong>X<\/strong>) is defined by\n<\/p>\n<img src=\"http:\/\/www.codechef.com\/download\/PARPOLY.png\" width=\"474\" height=\"74\" \/><br \/>\n<p>\nwhere <strong>P<\/strong> is a given polynomial <strong>P<\/strong>(<strong>x<\/strong>) = <strong>C<\/strong><sub><strong>D<\/strong><\/sub> \u00b7 <strong>x<\/strong><sup><strong>D<\/strong><\/sup> + <strong>C<\/strong><sub><strong>D<\/strong>-1<\/sub> \u00b7 <strong>x<\/strong><sup><strong>D<\/strong>-1<\/sup> + ... + <strong>C<\/strong><sub>1<\/sub> \u00b7 <strong>x<\/strong> + <strong>C<\/strong><sub>0<\/sub>.\n<\/p>\n\n<p>\nFor example,\n<\/p>\n<p>\n <strong>f<\/strong>(1, 3, <strong>X<\/strong>) = <strong>P<\/strong>(3<strong>X<\/strong>)\n<\/p>\n<p>\n <strong>f<\/strong>(2, 3, <strong>X<\/strong>) = <strong>P<\/strong>(0) <strong>P<\/strong>(3<strong>X<\/strong>) + <strong>P<\/strong>(<strong>X<\/strong>) <strong>P<\/strong>(2<strong>X<\/strong>) + <strong>P<\/strong>(2<strong>X<\/strong>) <strong>P<\/strong>(<strong>X<\/strong>) + <strong>P<\/strong>(3<strong>X<\/strong>) <strong>P<\/strong>(0) = 2 <strong>P<\/strong>(<strong>X<\/strong>) <strong>P<\/strong>(2<strong>X<\/strong>) + 2 <strong>P<\/strong>(0) <strong>P<\/strong>(3<strong>X<\/strong>)\n<\/p>\n<p>\n <strong>f<\/strong>(3, 1, <strong>X<\/strong>) = <strong>P<\/strong>(0) <strong>P<\/strong>(0) <strong>P<\/strong>(<strong>X<\/strong>) + <strong>P<\/strong>(0) <strong>P<\/strong>(<strong>X<\/strong>) <strong>P<\/strong>(0) + <strong>P<\/strong>(<strong>X<\/strong>) <strong>P<\/strong>(0) <strong>P<\/strong>(0) = 3 <strong>P<\/strong>(0)<sup>2<\/sup> <strong>P<\/strong>(<strong>X<\/strong>)\n<\/p>\n\n<p>\nCiel is a great chef. However, she is not very good at arithmetic. So she needs your help to make her win the contest.\nFor the given values of <strong>P<\/strong>, <strong>M<\/strong>, <strong>N<\/strong> and <strong>X<\/strong>, your work is to calculate the value of <strong>f<\/strong>(<strong>M<\/strong>, <strong>N<\/strong>, <strong>X<\/strong>).\nThe answer can be very large, so you should print the answer modulo 1000000007 (10<sup>9<\/sup>+7), that is, you need to find the remainder of division of <strong>f<\/strong>(<strong>M<\/strong>, <strong>N<\/strong>, <strong>X<\/strong>) by 1000000007 (10<sup>9<\/sup>+7).\n<\/p>\n\n<h3>Input<\/h3>\n<p>\nThe first line contains an integer <strong>T<\/strong>, the number of test cases.\nThen <strong>T<\/strong> test cases follow.\nThe first line for each test case has 3 integers <strong>M<\/strong>, <strong>N<\/strong> and <strong>X<\/strong>.\nThen the next line has <strong>D<\/strong>+2 integers. The first integer denotes <strong>D<\/strong>, and the (<strong>i<\/strong>+1)-th integer denotes <strong>C<\/strong><sub><strong>i<\/strong>-1<\/sub>.\n<\/p>\n\n<h3>Output<\/h3>\n<p>\nFor each test case, print the value of <strong>f<\/strong>(<strong>M<\/strong>, <strong>N<\/strong>, <strong>X<\/strong>) modulo 1000000007 (10<sup>9<\/sup>+7).\n<\/p>\n\n<h3>Constraints<\/h3>\n<p>\n1 \u2264 <strong>T<\/strong> \u2264 4<br \/>\n1 \u2264 <strong>M<\/strong> \u2264 400<br \/>\n1 \u2264 <strong>N<\/strong> \u2264 800<br \/>\n0 \u2264 <strong>X<\/strong> \u2264 1000000006 (10<sup>9<\/sup>+6)<br \/>\n0 \u2264 <strong>D<\/strong> \u2264 10<br \/>\n0 \u2264 <strong>C<\/strong><sub><strong>i<\/strong><\/sub> \u2264 1000000006 (10<sup>9<\/sup>+6)<br \/>\nIf <strong>D<\/strong> \u2260 0, then <strong>C<\/strong><sub><strong>D<\/strong><\/sub> \u2260 0<br \/>\n<\/p>\n\n<h3>Sample Input<\/h3>\n<pre>3\n1 3 2\n2 0 1 2\n2 3 0\n1 1 1\n3 1 1\n3 1 2 3 4<\/pre>\n\n<h3>Sample Output<\/h3>\n<pre>78\n4\n30<\/pre>\n\n<h3>Explanation<\/h3>\n<p>\nIn the first case, the polynomial is <strong>P<\/strong>(<strong>x<\/strong>) = 2 \u00b7 <strong>x<\/strong><sup>2<\/sup> + <strong>x<\/strong>.\nThe answer is <strong>P<\/strong>(3<strong>X<\/strong>) = <strong>P<\/strong>(6) = 2 \u00b7 36 + 6 = 78.\n<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"7","source_sizelimit":"50000","problem_author":"laycurse","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>laycurse<\/span>","problem_tester":"anton_lunyov","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>anton_lunyov<\/span>","date_added":"2-09-2011","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/binomial'>\n                    binomial\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>\n                    dynamic-programming\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/june12'>\n                    june12\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/laycurse'>\n                    laycurse\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/PARPOLY","user":{"username":null},"time":{"view_start_date":1339403708,"submit_start_date":1339403708,"visible_start_date":1339407000,"end_date":1735669800,"current":1493557845},"todo":false,"problem_status":"unattempted"}