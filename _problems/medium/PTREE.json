
{"category_name":"medium","status":"success","problem_code":"PTREE","problem_name":"Perfect Tree Problem","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/hindi\/PTREE.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/bengali\/PTREE.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/mandarin\/PTREE.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/russian\/PTREE.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/vietnamese\/PTREE.pdf) as well.\n\nA *perfect tree* is a rooted tree such that all its leaves are at the same distance from the root. The *value* of a perfect tree with $n$ vertices at a time $x$ is\n$$W(x) = \\mathrm{max}_p \\left(\\sum_{i=1}^{n} dist(p_i) \\cdot x^{i-1}\\right) \\;,$$\nwhere the vertices of the tree are (arbitrarily) numbered $1$ through $n$, the maximum is taken over all permutations $p$ of integers $1$ through $n$, and $dist(u)$ denotes the distance of vertex $u$ from the root.\n\nOur Chef has a perfect tree with $N$ vertices (numbered $1$ through $N$), which is rooted at vertex $1$. For any vertex $v$ of this tree, the value of the subtree rooted at $v$ (note that it is also a perfect tree) is defined in the same way as above, where the sum and permutations are only taken over vertices of this subtree and $dist()$ denotes the distance from vertex $v$.\n\nYou should answer $Q$ queries. In each query, Chef has two parametres $v$ and $y$ and he wants to know the value of the subtree rooted at vertex $v$, at time $y$. The queries are encoded in such a way that they have to be answered online. Since the values may be large, compute them modulo $1000000007$ ($10^9 + 7$).\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $Q$.\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting an edge between vertices $u$ and $v$.\n- The following $Q$ lines describe queries. Each of these lines contains two space-separated integers $a$ and $b$. The parametres $v$ and $y$ are computed in the following way: let's denote the answer to the previous query by $ans$ ($ans = 0$ for the first query); then, $v = a \\oplus ans$ and $y = b \\oplus ans$.\n\n### Output\nFor each query, print a single line containing one integer - the value of the given subtree modulo $10^9 + 7$.\n\n### Constraints \n- $1 \\le T \\le 5$\n- $1 \\le N \\le 200,000$\n- $1 \\le Q \\le 100,000$\n- $1 \\le u, v \\le N$\n- $1 \\le y \\lt 10^9+7$\n- the graph described on the input is a perfect tree\n- the sum of $N$ over all test cases does not exceed $200,000$\n- the sum of $Q$ over all test cases does not exceed $100,000$\n\n###Subtasks\n- Subtask 1 (20 points) : \n\n    $1 \\leq $ Sum of $N$ over all test cases $\\leq 10000$\n\n    $1 \\leq $ Sum of $Q$ over all test cases $\\leq 8000$\n\n- Subtask 2 (80 points) : \n\n    Original Constraints\n\n### Example Input\n```\n1\n6 3\n1 2\n1 3\n2 4\n2 5\n3 6\n1 1\n10 10\n5 5\n```\n\n### Example Output\n```\n8\n6\n3\n```\n\n### Explanation\n**Example case 1:** For the first query, the choice of the permutation $p$ is irrelevant, the inner sum (and therefore the value of the tree) is always just the sum of distances of all vertices from vertex $1$. Hence, the answer is $0+1+1+2+2+2 = 8$.\n\nIn the second query, $v = 2$ and $y = 2$.\n\nIn the third query, $v = 3$ and $y = 3$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"2.5","source_sizelimit":"50000","problem_author":"yash_chandnani","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>yash_chandnani<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"14-02-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/agp'>agp<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/amortization'>amortization<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/march19'>march19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/observations'>observations<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/yash_chandnani'>yash_chandnani<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/PTREE","time":{"view_start_date":1552469402,"submit_start_date":1552469402,"visible_start_date":1552469402,"end_date":1735669800,"current":1559472981},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}