{"category_name":"medium","status":"success","problem_code":"QUEHEA","problem_name":"Queen of Hearts","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/mandarin\/QUEHEA.pdf\">Mandarin Chinese<\/a>, <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/russian\/QUEHEA.pdf\">Russian<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK73\/vietnamese\/QUEHEA.pdf\">Vietnamese<\/a> as well.<\/h3>\n\n<p>\nWonderland is a wonderful world inhabited by <b>N<\/b> strange creatures, for simplicity all creatures are numbered from <b>1<\/b> to <b>N<\/b>. Every creature has exactly one best friend (it could be himself too). Note that, the friendship relationship is not bidirectional, meaning that it might be the case person x is best friend of y, but y is  not best friend of x. Besides that, there is a very intricate admiration relationship among the creatures. Every creature admires himself and to all the creatures admired by his best friend.\n<\/p>\n\n<p>\nWonderland is divided in many guilds, each creature belonging to exactly one guild, also each guild contains at least one creature. A guild is defined as the largest set of creatures in which if we take any two creatures <b>i<\/b>, <b>j<\/b>, then there exists a creature <b>k<\/b> such that both <b>i<\/b> and <b>j<\/b> admire <b>k<\/b>. For given best friend relationship for all persons, the guilds formed will be uniquely defined.\n<\/p>\n\n<p>\nThe queen of hearts is very angry because someone stole her tarts, so she is going to perform many executions. After the executions some of the creatures will lose his best friend, and will stop admiring all the creatures admired by his best friend, in consequence the number of guilds could change.\n<\/p>\n\n<p>\nAlice have <b>Q<\/b> queries of the form <b>L, R<\/b>, and she asks you to determine the number of guilds after the executions if the only survivors are the creatures numbered from <b>L<\/b> to <b>R<\/b>.\n<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of the input contains two integers <b>N<\/b> and <b>Q<\/b>.<\/p>\n<p>In the next line there are <b>N<\/b> space separated integers, the i-th integer <b>a<sub>i<\/sub><\/b> represents the best friend of the i-th creature.<\/p>\n<p>Then follows <b>Q<\/b> lines each one with two integers <b>L, R<\/b> representing one query.<\/p>\n\n<h3>Output<\/h3>\n<p>For each query, output the number of guilds after the execution.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>N, Q<\/b> \u2264 <b>10<sup>5<\/sup><\/b><\/li>\n<li><b>1<\/b> \u2264 <b>L<\/b>  \u2264  <b>R<\/b> \u2264 <b>N<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>a<sub>i<\/sub><\/b>  \u2264  <b>N<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b><tt>\n9 3\n2 8 4 3 9 9 8 3 3\n1 6\n7 9\n3 6\n<\/tt>\n<b>Output:<\/b><tt>\n4\n2\n3<\/tt>\n<\/pre>\n\n<h3>Explanation<\/h3>\n<p>Initially there is just one guild.<\/p>\n<p>After the executions of the first query the guilds will be <b>{ {1, 2}, {3, 4}, {5},{6} }<\/b>.<\/p>\n<p>After the executions of the second query the guilds will be <b>{ {7, 8}, {9} }<\/b>.<\/p>\n<p>After the executions of the third query the guilds will be <b>{ {3,4}, {5},{6} }<\/b>.<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"alei","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>alei<\/span>","problem_tester":"kingofnumbers","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>kingofnumbers<\/span>","date_added":"25-07-2016","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alei'>\n                    alei\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/cook73'>\n                    cook73\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>\n                    data-structure\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/qeahea'>\n                    qeahea\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a>","editorial_url":"https:\/\/discuss.codechef.com\/questions\/84223\/qeahea-editorial","user":{"username":null},"time":{"view_start_date":1471804200,"submit_start_date":1471804200,"visible_start_date":1471804200,"end_date":1735669800,"current":1493557875},"todo":false,"problem_status":"unattempted"}