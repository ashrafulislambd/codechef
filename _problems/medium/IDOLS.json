{"category_name":"medium","status":"success","problem_code":"IDOLS","problem_name":"Idols and Fans","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK47\/mandarin2\/IDOLS2.pdf\">Mandarin Chinese<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK47\/russian\/IDOLS1.pdf\">Russian<\/a> as well.<\/h3>\n<p>Mike is a cool kid, so he's the most popular person in his school. All the girls want to be with him while all the boys want to be like him.<\/p>\n<p>There are <b>N<\/b> persons in Mike's school. No person in the school has a name(except Mike), but all of them have a unique ID integer number for the range[1..<b>N<\/b>]. Mike's ID equals to 1. Also, each person(except Mike) has his\/her <i>personal idol<\/i>, who is another person from the school. Finally, each person <b>X<\/b> has an integer number <b>A<sub>X<\/sub><\/b>.<\/p>\n<p>Let's define functions <b>F<\/b> and <b>G<\/b> for a person with ID equals to <b>X<\/b>:<\/p>\n<p><ul>\n<li>If <b>X<\/b> = 1(which means that person <b>X<\/b> is Mike), then <b>F<sub>X<\/sub><\/b> = <b>A<sub>X<\/sub><\/b> and <b>G<sub>X<\/sub><\/b> = 1;\n<\/li><li>Otherwise, let <b>Y<\/b> be the personal idol for <b>X<\/b>.\n<ul>\n<li>If <b>F<sub>Y<\/sub><\/b> + 1 &lt; <b>A<sub>X<\/sub><\/b>, then <b>F<sub>X<\/sub><\/b> = <b>A<sub>X<\/sub><\/b> and <b>G<sub>X<\/sub><\/b> = 1;\n<\/li><li>If <b>F<sub>Y<\/sub><\/b> + 1 > <b>A<sub>X<\/sub><\/b>, then <b>F<sub>X<\/sub><\/b> = <b>F<sub>Y<\/sub><\/b> + 1 and <b>G<sub>X<\/sub><\/b> = <b>G<sub>Y<\/sub><\/b>;\n<\/li><li>If <b>F<sub>Y<\/sub><\/b> + 1 = <b>A<sub>X<\/sub><\/b>, then <b>F<sub>X<\/sub><\/b> = <b>F<sub>Y<\/sub><\/b> + 1 and <b>G<sub>X<\/sub><\/b> = <b>G<sub>Y<\/sub><\/b> + 1.\n<\/li><\/ul>\n<\/li><\/ul>\n<\/p>\n<p>It's guaranteed, that it's possible to calculate functions <b>F<\/b> and <b>G<\/b> for every person in the school.<\/p>\n<p>\nYou are to write a program, that can efficiently process queries of the following types:<\/p>\n<ul>\n<li>0 <b>X<\/b> <b>NEW_VALUE<\/b> - change the value of <b>A<sub>X<\/sub><\/b> to <b>NEW_VALUE<\/b>;\n<\/li><li>1 <b>X<\/b> - calculate <b>F<sub>X<\/sub><\/b> and <b>G<sub>X<\/sub><\/b>.\n<\/li><\/ul>\n\n<h3>Input<\/h3>\n<p>The first line of the input contains two integers <b>N<\/b> and <b>Q<\/b>, denoting the number of the persons in Mike's school and the number of queries to process.<\/p>\n<p>The second line contains <b>N<\/b> integers <b>A<sub>i<\/sub><\/b>, denoting <b>A<sub>1<\/sub><\/b>, <b>A<sub>2<\/sub><\/b>, ..., <b>A<sub>N<\/sub><\/b>.<\/p>\n<p>The third line contains <b>N - 1<\/b> integers <b>P<sub>i<\/sub><\/b>, denoting the personal idols of persons with IDs equal to 2, 3, ..., <b>N<\/b>. 1 \u2264 <b>P<sub>i<\/sub><\/b> &lt; <b>i<\/b>. <\/p>\n<p>The next <b>Q<\/b> lines contain information about the queries. The format of the queries is the same with the one described in the statement.<\/p>\n<h3>Output<\/h3>\n<p>For each query of the second type, output a single line containing two integers, <b>F<sub>X<\/sub><\/b> and <b>G<sub>X<\/sub><\/b>.<\/p>\n<h3>Constraints<\/h3>\n<p>1 \u2264 <b>N<\/b> \u2264 100000;<\/p>\n<p>1 \u2264 <b>Q<\/b> \u2264 300000;<\/p>\n<p>1 \u2264 <b>A<sub>i<\/sub><\/b> \u2264 10<sup>9<\/sup>, for each person;<\/p>\n<p>1 \u2264 <b>X<\/b> \u2264 <b>N<\/b>, 1 \u2264 <b>NEW_VALUE<\/b> \u2264 10<sup>9<\/sup>, for each query of the first type.<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n5 2\n1 2 3 4 5\n1 2 3 4\n1 5\n0 1 100\n\n<b>Output:<\/b>\n5 5\n<\/pre><h3>Explanations<\/h3>\n<p>\nIn the input, before the second query, <b>F<\/b>'s and <b>G's<\/b> equals to the following:\n<\/p>\n<p><table>\n<tr>\n<td><b>ID<\/b><\/td>\n<td><b>F<\/b><\/td>\n<td><b>G<\/b><\/td>\n<\/tr>\n<tr>\n<td>1<\/td>\n<td>1<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>2<\/td>\n<td>2<\/td>\n<td>2<\/td>\n<\/tr>\n<tr>\n<td>3<\/td>\n<td>3<\/td>\n<td>3<\/td>\n<\/tr>\n<tr>\n<td>4<\/td>\n<td>4<\/td>\n<td>4<\/td>\n<\/tr>\n<tr>\n<td>5<\/td>\n<td>5<\/td>\n<td>5<\/td>\n<\/tr>\n<\/table>\n<\/p>\n<p>\nAfter the second query, <b>F<\/b>'s and <b>G's<\/b> equals to the following:\n<\/p>\n<p><table>\n<tr>\n<td><b>ID<\/b><\/td>\n<td><b>F<\/b><\/td>\n<td><b>G<\/b><\/td>\n<\/tr>\n<tr>\n<td>1<\/td>\n<td>100<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>2<\/td>\n<td>101<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>3<\/td>\n<td>102<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>4<\/td>\n<td>103<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>5<\/td>\n<td>104<\/td>\n<td>1<\/td>\n<\/tr>\n<\/table>\n<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2","source_sizelimit":"50000","problem_author":"kostya_by","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>kostya_by<\/span>","problem_tester":"rustinpiece","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #1E7D22;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>2&#9733;<\/span><span>rustinpiece<\/span>","date_added":"31-05-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook47'>\n                    cook47\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/heavy-light'>\n                    heavy-light\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/kostya_by'>\n                    kostya_by\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/IDOLS","user":{"username":null},"time":{"view_start_date":1403464500,"submit_start_date":1403464500,"visible_start_date":1403464500,"end_date":1735669800,"current":1493557694},"todo":false,"problem_status":"unattempted"}