{"category_name":"medium","status":"success","problem_code":"MAXMATCH","problem_name":"Maximum Matching","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME24\/mandarin\/MAXMATCH.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME24\/russian\/MAXMATCH.pdf\">Russian<\/a>.<\/h3>\n<p>\nDevu is very frustrated with the following problem. So, he wants your help in solving it.\n<\/p>\n<p>\nGiven a set: <b> S = {1,2,3,....,N}<\/b>\n<\/p>\n<p>\nMake a bipartite graph having partites <b>X<\/b> and <b>Y<\/b>. Partite <b>X<\/b> will contain all permutations of Set <b>S<\/b>. Partite <b>Y<\/b> will contain all strings of length <b>(N-1)<\/b>  having characters <b>\u2018I\u2019<\/b> and <b>\u2018D\u2019<\/b> only. Note that number of vertices in partite <b>X<\/b> will be <b>N!<\/b> and <b>2<sup>(N-1)<\/sup><\/b> in partite <b>Y<\/b>.\n<\/p>\n<p>\n Consider a vertex <b>x<\/b> in partite <b>X<\/b> and a vertex <b>y<\/b> in partite <b>Y<\/b>.\n<\/p>\n<p>\nstring <b>y<\/b> will be signature of permutation <b>x<\/b> if :\n<\/p>\n<p>\n<b><br \/>\ny[i] = \u2018I\u2019  => x[i] &lt; x[i+1]  &amp;& y[i] = \u2018D\u2019 => x[i] > x[i+1] \u2026. for all i from 0 to N-2.<br \/>\n<\/b>\n<\/p>\n<p>\nThere will be an edge between permutation <b>x<\/b> and string <b>y<\/b> if string <b>y<\/b> is the signature of the permutation <b>x<\/b> and weight of the edge will be the square of the inversion count in permutation <b>x<\/b>.\n<\/p>\n<p>\nYou need to find the maximum weighted matching in the given bipartite graph. As the answer can be very large, print it modulo <b>M<\/b>.\n<\/p>\n<h3>Input<\/h3>\n<ul>\n<li>First line of the input contains integers <b>T<\/b>, denoting the number of test cases and <b>M<\/b>.  <\/li>\n<li>Next <b>T<\/b> lines will be containing the value of <b>N<\/b><\/li>\n<\/ul>\n<h3>Output<\/h3>\n<p>For each test case, print a single integer representing the answer of that test case.<\/p>\n<h3>Constraints<\/h3>\n<p><ul>\n<li><b>2 \u2264 M  \u2264 10<sup>9<\/sup><\/b><\/li>\n<\/ul>\n<\/p>\n<p>\n<b>Subtask #1: 8 points<\/b><\/p>\n<ul>\n<li><b>1 \u2264 T  \u2264 20, 2 \u2264 N  \u22648.<\/b><\/li>\n<\/ul>\n\n<p>\n<b>Subtask #2: 22 points<\/b><\/p>\n<ul>\n<li><b>1 \u2264 T  \u2264 20, 2 \u2264 N \u2264 15.<\/b><\/li>\n<\/ul>\n\n<p>\n<b>Subtask #3: 70 points<\/b><\/p>\n<ul>\n<li><b>1 \u2264 T  \u2264 20, 2 \u2264 N  \u2264 2000 <\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<p><pre><b>Input:<\/b>\n2 1007\n2\n3\n\n<b>Output:<\/b>\n1\n17\n<\/pre><\/p>\n<h3>Explanation<\/h3>\n<p>\n<b>For N=3, graph can be shown as below:<\/b>\n<\/p>\n<p>\n<img src=\"\/download\/extimages\/e0e32ec8077fe8a8e8a759c8d8f5d9eb.jpg\" alt=\"Mountain View\" style=\"width:380px;height:450px\" width=600 \/><\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"amitpandeykgp","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>amitpandeykgp<\/span>","problem_tester":"xcwgf666","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","date_added":"20-04-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/amitpandeykgp'>\n                    amitpandeykgp\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>\n                    combinatorics\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>\n                    dynamic-programming\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ltime24'>\n                    ltime24\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/MAXMATCH","user":{"username":null},"time":{"view_start_date":1433061000,"submit_start_date":1433061000,"visible_start_date":1433061000,"end_date":1735669800,"current":1493557785},"todo":false,"problem_status":"unattempted"}