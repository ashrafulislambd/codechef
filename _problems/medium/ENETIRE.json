
{"category_name":"medium","status":"success","problem_code":"ENETIRE","problem_name":"Our Enemy does not Tire","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>**Jon Snow** has to defeat the army of the **Night King**.     \nFor that he needs to increase the power of the **Dragon Glass.**  \n\nDragon Glass's power depends on certain numbers, described as follows.  \n\nDragon Glass follows its own number system, which comprises $Y$ integers ranging in  $[0,Y-1]$.         \n\nNormally, there are bases like base 2 (binary) , 8 (octal)  , 10 (decimal) , etc.    \nIn this new number system, there are total $(X+1)$ bases, ranging from base $2$ to base $X+2$ in which these $Y$ numbers can be represented.    \n\nJon Snow initially has exactly $M$ **distinct numbers** in base $2$. $(1<=M<=Y)$       \n\nIf a number $b$ is in base $a$, it can be transformed into 3 of the following -  \n\n - Number $b+1$ in base $a+1$, if $0 \\leq b+1 \\leq Y-1$\n - Number $b$ in base $a+1$\n - Number $b-1$ in base $a+1$, if $0 \\leq b-1 \\leq Y-1$\n\nThese transformations have some restrictions, which are detailed below.\n\nSo, let\u2019s say $Y$ = 10 (**numbers range from [0-9]**). And $M$ be 3.   \nLet those $M$ numbers we initially have in base $2$ be 4, 7 and 9.  \nSo, **4 in base 2** can be transformed into **3, 4 and 5 in base 3**.  \nSimilarly, **7 in base 2** can be transformed into **6,7 and 8 in base 3**.  \nSimilarly, **9 in base 2** can be transformed into **8 and 9 in base 3**.     \n**3 in base 3** can be transformed into **2, 3 and 4 in base 4.**  \nAnd, so on....... .... .....   \n\nBut, the dragon glass is not perfect.  \n**Some of the combinations of bases and numbers are blocked i.e can't be obtained.** In other words, you cannot transform into any of these combinations. \n\nThere are $N$ total such combinations which can't be obtained.  \nThese combinations are of the following form -   \n\n - $a$  $b$ \nIt denotes that number $b$ in base $a$ is blocked i.e can't be obtained. \n**There are at most 200 distinct bases in which numbers can\u2019t be obtained.**  That is, among the $N$ blocked combinations, there are at most 200 distinct bases. \n\nSuppose that currently we have number $b$ in base $a$.    \nIf the number $b$ and $b+1$ are blocked to be obtained in base $a+1$, then number $b$ in base $a$ can be transformed into $b+1$ in base $a$ (**provided it is not blocked**).    \nIf the number $b$ and $b-1$ are blocked to be obtained in base $a+1$, then number $b$ in base $a$ can be transformed into $b-1$ in base $a$ (**provided it is not blocked**).         \n\n**Also, one can never go back to a combination\/pair which was obtained in the past.**   \nIn other words, let\u2019s say we have $(a,b)$ - ( number $b$ in base $a$ ), and we apply some sequence of transformations to it and obtain $(c,d)$ - ( number $d$ in base $c$), \n\n$(a,b) \\rightarrow  \u2026 ... ... \\rightarrow (c,d)$     \nThen $(a,b)  \u2026.. \\rightarrow  (c,d) \\rightarrow  \u2026.. \\rightarrow  (a,b)$ is not allowed.\n\nYou need to help Jon Snow find **the number of ways to obtain numbers in base $(X+2)$ i.e the last base as stated above**. In other words, you have to find the number of different sequences of transformations, which start out with one of the $M$ numbers in base 2, and end with some number in base $X+2$.\n\n**As the value can be very high, print it mod** $10^9+7$.  \nPlease refer sample examples for more explanation.  \n\n\n###Input:\n\n- First line will contain 4 space separated integers - $Y,X,M,N$ .\n- Second line comprises $M$ distinct space separated integers denoting the numbers in the range $[0,Y-1]$ initially in base 2.    \n- $N$ lines follow. Each line comprises 2 space separated integers $a$ $b$ denoting the number $b$ in base $a$ is blocked i.e can't be obtained.\n\n###Output:\nOutput in a single line number of ways to obtain numbers in base $X+2$ modulo $10^9+7$.\n\n###Constraints \n- $1 \\leq  Y \\leq 200$\n- $1 \\leq X \\leq 10^9$   \n- $1 \\leq M \\leq Y $  (These $M$ elements range in $[0, Y-1]$)\n- $0 \\leq N \\leq 200*Y $ (as only 200 distinct bases will have numbers that can't be obtained)  \n- $3 \\leq a \\leq X+1$ \n- $0 \\leq b \\leq Y-1$\n\n###Sample Input 1:\n  \n  3 3 1 3   \n  0      \n  3 0    \n  3 1   \n  4 2\n\n\n###Sample Output 1:\n\t3\n\t\n###EXPLANATION 1:\n$Y$ = 3 (The Number system has integers only in range [0,2]).    \n$X$ = 3 ( The bases range from base 2 to base 5).    \n$M$ = 1 ( At base 2, only 1 number is present).   \nArray of $M$ integers  = {0} ( Only number 0 is present initially at base 2).     \n$N$ = 3 ( There are 3 combinations that are blocked\/can't be obtained )     \nArray of length $N$ = { ( 3, 0), (3, 1), (4,2) } (Number 0 and 1 in base 3 can never be obtained, and number 2 in base 4 can never be obtained).      \n\nThe answer is 3. \nThe possible ways are obtained as follows -\n\nNumber 0 in base 2 can transform into number 0 and number 1 in base 3.   \nBut, both these numbers can\u2019t be obtained. So, number 0 in base 2 can be transformed to number 1 in base 2.    \nThis number 1 in base 2 can be transformed into number 2 in base 3.     \nThis number 2 in base 3 can be transformed into number 1 in base 4.     \nThis number 1 in base 4 can be transformed into **number 0 in base 5, number 1 in base 5 or number 2 in base 5.**     \n\nThus at base (X+2) i.e base 5, there are 3 ways of obtaining numbers.         \n\n###Sample Input 2:\n  \n  3 3 1 2   \n  0      \n  3 0    \n  3 1      \n\n###Sample Output 2:\n\t5   \n\n###EXPLANATION 2:  \n$Y$ = 3 (The Number system has integers only in range [0,2]).    \n$X$ = 3 ( The bases range from base 2 to base 5).   \n$M$ = 1 ( At base 2, only 1 number is present).   \nArray of $M$ integers  = {0} ( Only number 0 is present initially at base 2).     \n$N$ = 2 ( There are 2 combinations that are blocked\/can't be obtained )      \nArray of length $N$ = { ( 3, 0), (3, 1) } (Number 0 and 1 in base 3 can never be obtained).     \n\nThe answer is 5.       \nThe possible ways are obtained as follows -        \n\nNumber 0 in base 2 can transform into number 0 and number 1 in base 3.       \nBut, both these numbers can\u2019t be obtained. So, number 0 in base 2 can be transformed to number 1 in base 2.        \nThis number 1 in base 2 can be transformed into number 2 in base 3.        \nThis number 2 in base 3 can be transformed into number 1 in base 4, and number 2 in base 4.    \nThis number 1 in base 4 can be transformed into **number 0 in base 5, number 1 in base 5 or number 2 in base 5.**       \nThe number 2 in base 4 can be transformed into **number 1 in base 5 or number 2 in base 5**.      \n\nThus at base (X+2) i.e base 5, there are 5 ways of obtaining numbers.    \n\n\n###Sample Input 3:\n  \n  4 2 2 2  \n  1 2        \n  3 1    \n  3 2      \n\n###Sample Output 3:  \n\t8     \n\n###EXPLANATION 3:   \n$Y$ = 4 (The Number system has integers only in range [0,3]).    \n$X$ = 2 ( The bases range from base 2 to base 4).    \n$M$ = 2 ( At base 2, only 2 numbers are present).   \nArray of $M$ integers  = {1,2} ( Only numbers 1 and 2 are present initially at base 2).    \n$N$ = 2 ( There are 2 combinations that are blocked\/can't be obtained )    \nArray of length $N$ = { ( 3, 1), (3, 2) } (Number 1 and 2 in base 3 can never be obtained).           \n\nThe number 1 in base 2 can transform into numbers 0,1 and 2 in base 3.      \nBut numbers 1 and 2 in base 3 can't be obtained. So, number 1 in base 2 can be transformed into number 2 in base 2.     \nThe number 2 in base 2  can be transformed into number 3 in base 3.        \nThe number 3 in base 3 can be transformed into **numbers 2 and 3 in base 4.**          \n\nThe number 0 in base 3 can be transformed into **numbers 0 and 1 in base 4**  .   \n\nSimilarly, one can find 4 other ways.      \nTotal number of ways to obtain numbers at base (X+2) i.e base 4 are 8.\n   ","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, R, COB, FS","max_timelimit":"2","source_sizelimit":"50000","problem_author":"shivamg_isc","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>shivamg_isc<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"2-04-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/shivamg_isc'>shivamg_isc<\/a>","time":{"view_start_date":1554669000,"submit_start_date":1554669000,"visible_start_date":1554669000,"end_date":1735669800,"current":1559472973},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}