
{"category_name":"medium","status":"success","problem_code":"IAI","problem_name":"Intervals and Intersections","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/LTIME72\/hindi\/IAI.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/LTIME72\/bengali\/IAI.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/LTIME72\/mandarin\/IAI.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/LTIME72\/russian\/IAI.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/LTIME72\/vietnamese\/IAI.pdf) as well.\n\nVivek believes that this problem is the hardest problem ever and no one can solve it. Please prove him wrong.\n\nYou are given a sequence $A_1, A_2, \\ldots, A_N$ and $M$ intervals $[L_1, R_1], [L_2, R_2], \\ldots, [L_M, R_M]$. For any subset $S$ of these intervals:\n- If $S$ is non-empty, let's define $L = \\mathrm{max}_{i \\in S}\\,(L_i)$ and $R = \\mathrm{min}_{i \\in S}\\,(R_i)$.\n- The set $S$ is *disjoint* if $S$ is empty or $L \\gt R$. Otherwise, the intersection of the intervals from this set is the interval $[L, R]$.\n- If $S$ is not disjoint, its value is $\\sum_{j=L}^{R} (j-L+1) \\cdot A_j$.\n\nFind the maximum of values of all non-disjoint subsets of the given intervals.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains two space-separated integers $N$ and $M$.\n- The second line contains $N$ space-separated integers $A_1, A_2, \\ldots, A_N$.\n- $M$ lines follow. For each $i$ ($1 \\le i \\le M$), the $i$-th of these lines contains two space-separated integers $L_i$ and $R_i$.\n\n### Output\nFor each test case, print a single line containing one integer \u2015 the maximum value of a non-disjoint subset.\n\n### Constraints \n- $1 \\le T \\le 5$\n- $1 \\le N \\le 10^5$\n- $1 \\le M \\le 5 \\cdot 10^4$\n- $|A_i| \\le 10^6$ for each valid $i$\n- $1 \\le L \\le R \\le N$\n\n### Subtasks\n**Subtask #1 (30 points):** $1 \\le M \\le 3 \\cdot 10^3$\n\n**Subtask #2 (70 points):** original constraints\n\n### Example Input\n```\n2\n3 2\n-2 1 -2\n1 2\n2 3\n3 2\n2 3 4\n1 2\n2 3\t\n```\n\n### Example Output\n```\n1\n11\n```\n\n### Explanation\n**Example case 1:** It is optimal to choose the intervals $[1, 2]$ and $[2, 3]$. Their intersection is the interval $[2, 2]$ (so the set of these two intervals is not disjoint) and its value is $A_2 \\cdot 1 = 1$.\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, R, COB, FS","max_timelimit":"4","source_sizelimit":"50000","problem_author":"vivek_1998299","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>vivek_1998299<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"17-05-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/convex-hull-trick'>convex-hull-trick<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/ltime72'>ltime72<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>medium-hard<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/prefix-sum'>prefix-sum<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>segment-tree<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/taran_1407'>taran_1407<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/vivek_1998299'>vivek_1998299<\/a>","time":{"view_start_date":1558803600,"submit_start_date":1558803600,"visible_start_date":1558803600,"end_date":1735669800,"current":1559472974},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}