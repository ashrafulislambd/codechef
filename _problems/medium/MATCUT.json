{"category_name":"medium","status":"success","problem_code":"MATCUT","problem_name":"Mathison and the cubic tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME51\/mandarin\/MATCUT.pdf\">mandarin chinese<\/a>, <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME51\/russian\/MATCUT.pdf\">russian<\/a> and <a target=\"_blank\" \nhref=\"http:\/\/www.codechef.com\/download\/translated\/LTIME51\/vietnamese\/MATCUT.pdf\">vietnamese<\/a> as well.<\/h3>\n\n<p>\n  After playing board games, buying letters, and shuffling decks, Mathison has finally decided to study. He opens his favorite book,\n  <a href=\"https:\/\/mitpress.mit.edu\/books\/introduction-algorithms\">CLRS<\/a>, and decides to solve a graph problem. The problem is described below and you can find it by its number, 25.1-11, on page 693 (3<sup>rd<\/sup> edition only).\n<\/p>\n\n<p>\n  You are given a <abbr title=\"a tree is an undirected graph in which any two vertices are connected by exactly one path\">tree<\/abbr>\n  with <b>N<\/b> nodes where each node has a value associated with it.\n<\/p>\n\n<p>\n  Define <b>PROD<\/b>(<b>u<\/b>, <b>v<\/b>) to be the product of all values on the path from node <b>u<\/b> to node <b>v<\/b>.\n<\/p>\n\n<p>\n  The problem is to find the <abbr title=\"the one with the highest number of nodes\"><b>longest path<\/b><\/abbr> (<b>u<\/b>, <b>v<\/b>) such that <b>PROD<\/b>(<b>u<\/b>, <b>v<\/b>) is a\n  <abbr title=\"A cubic number is a figurate number of the form n^3 with n a positive integer.\"><b>cubic number<\/b><\/abbr>\n  (i.e. there is some natural number k such that k<sup>3<\/sup> = <b>PROD<\/b>(<b>u<\/b>, <b>v<\/b>)).\n<\/p>\n\n<p>\n  Mathison has no idea how to solve this problem so he asks you for help! <br \/>\n  Given <b>T<\/b> instances of this task, can you find the answer for each one of them so Mathison can proceed to the next chapter?\n<\/p>\n\n<h3>Input<\/h3>\n<p>\n  The first line contains the number of tests, <b>T<\/b>.\n<\/p>\n\n<p>\n  The description of a test starts with one line that contains the number of nodes, <b>N<\/b>.\n<\/p>\n\n<p>\n  The second line contains <b>N<\/b> space-separated integers, representing the values of the nodes.\n<\/p>\n\n<p>\n  Each of the following <b>N-1<\/b> lines contain a single pair of integers <b>u<\/b>, <b>v<\/b>, representing an edge from <b>u<\/b> to <b>v<\/b>.\n<\/p>\n\n\n<h3>Output<\/h3>\n<p>\n  The output file must contain <b>T<\/b> lines, each one containing the answer (i.e. the longest path that generates a cubic number) for the corresponding test. If there's no such path then output <b>-1<\/b> instead.\n<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 5000<\/li>\n<li>1 \u2264 <b>N<\/b> \u2264 100,000 (i.e. 10<sup>5<\/sup>)<\/li>\n<li>1 \u2264 <b>value<sub>x<\/sub><\/b> \u2264 1,000,000 (i.e. 10<sup>6<\/sup>)<\/li>\n<\/ul>\n\n<h3>Subtaks<\/h3>\n<p><b>Subtask #1<\/b> (10 points):\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 5000<\/li>\n<li>1 \u2264 <b>N<\/b> \u2264 10<\/li>\n<li>All <b>values<\/b> are \u2264 50<\/li>\n<li><b>TL<\/b> = 1s<\/li>\n<\/ul>\n<\/p>\n\n<p><b>Subtask #2<\/b> (25 points):\n<ul>\n<li>1 \u2264 <b>T<\/b> \u2264 50<\/li>\n<li>1 \u2264 <b>N<\/b> \u2264 300<\/li>\n<li><b>TL<\/b> = 2s<\/li>\n<\/ul>\n<\/p>\n\n<p><b>Subtask #3<\/b> (25 points):\n<ul>\n<li>The <b>sum<\/b> of all <b>N<\/b>s is \u2264 300,000<\/li>\n<li>All <b>values<\/b> are \u2264 150<\/li>\n<li><b>TL<\/b> = 3.5s<\/li>\n<\/ul>\n<\/p>\n\n<p><b>Subtask #4<\/b> (40 points):\n<ul>\n<li>The <b>sum<\/b> of all <b>N<\/b>s is \u2264 300,000<\/li>\n<li>Original constraints for <b>N<\/b> and <b>value<sub>x<\/sub>.<\/b><\/li>\n<li><b>TL<\/b> = 4.5s<\/li>\n<\/ul>\n<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n4\n10\n525 1210 15 6 40 22 441 35 220 121\n2 1\n1 3\n7 3\n2 5\n2 4\n5 8\n6 5\n9 5\n9 10\n3\n2 3 5\n1 2\n2 3\n5\n2 4 2 2 8\n1 2\n1 3\n3 4\n5 4\n2\n125 3\n1 2\n\n<b>Output:<\/b>\n3\n-1\n4\n1\n<\/pre>\n\n<h3>Explanation<\/h3>\n<pre>\nFirst test\n<img src=\"https:\/\/image.ibb.co\/eSkERk\/tree.png\" width=\"70%\" height=\"70%\"\/>\n\nThere is only one path that generates a cubic number: 2 \u2192 5 \u2192 9; 1210 \u00d7 40 \u00d7 220 = 10648000 = 220<sup>3<\/sup>\nThere are 3 nodes in this path so the answer is 3.\n\nSecond test\nThere is no path that generates a cubic number so the answer is -1.\n\nThird test\nThere are two paths that generate a cubic number: 1 \u2192 2 and 1 \u2192 3 \u2192 4 \u2192 5.\nThe second one is longer so the answer is 4.\n\nFourth test\nThere is only one path that generates a cubic number and it contains only one node.\n<\/pre>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 6.3, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, kotlin, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.5, RUBY, rust, SCALA, SCM chicken, SCM guile, SCM qobi, ST, swift, TCL, TEXT, WSPC","max_timelimit":"1 - 4.5","source_sizelimit":"50000","problem_author":"alexvaleanu","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>alexvaleanu<\/span>","problem_tester":"kingofnumbers","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>kingofnumbers<\/span>","date_added":"23-08-2017","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/alexvaleanu'>\n                    alexvaleanu\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hashing'>\n                    hashing\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ltime51'>\n                    ltime51\n                <\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/MATCUT","time":{"view_start_date":1503768600,"submit_start_date":1503768600,"visible_start_date":1503768600,"end_date":1735669800,"current":1514816592},"user":{"username":null},"todo":false,"problem_status":"unattempted"}