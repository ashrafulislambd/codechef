{"category_name":"hard","status":"success","problem_code":"SLIS","problem_name":"Second LIS","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK63\/mandarin\/SLIS.pdf\">Mandarin Chinese<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK63\/russian\/SLIS.pdf\">Russian<\/a> as well.<\/h3>\n<p>\nGiven a sequence of <b>n<\/b> numbers <b>A<\/b>[<b>1<\/b>..<b>n<\/b>], a length-<b>k<\/b> increasing subsequence (IS) is <b>A<\/b>[<b>i<\/b><sub>1<\/sub>], <b>A<\/b>[<b>i<\/b><sub>2<\/sub>], ..., <b>A<\/b>[<b>i<\/b><sub>k<\/sub>] such that both the indices <b>i<\/b> and values are strictly increasing. Among all possible IS's, denote the maximum length as <b>L<\/b>. Now we are interested in finding how many length-<b>(L-1)<\/b> IS's are there.\n<\/p>\n<p>\nTwo IS's are different if and only if their indices are different.\n<\/p>\n<p>\nSince the answer could be very large, you are just required to output its remainder with <b>10^9 + 7<\/b>.\n<\/p>\n<h3>Input<\/h3>\n<p>The first line contains an integer <b>T<\/b> denoting the total number of test cases.<\/p>\n<p>For each test case, the first line contains a single integer <b>n<\/b>, and the second line contains the space-separated sequence <b>A<\/b>[<b>1<\/b>..<b>n<\/b>].<\/p>\n<h3>Output<\/h3>\n<p>For each test case, output the answer per line.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> &lt;= <b>T<\/b> &lt;= <b>10<\/b><\/li>\n<li><b>1<\/b> &lt;= <b>n<\/b> &lt;= <b>10^5<\/b><\/li>\n<li><b>1<\/b> &lt;= <b>A<\/b>[<b>i<\/b>] &lt;= <b>10^9<\/b><\/li>\n<li><b>1<\/b> &lt; <b>L<\/b><\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n3\n3\n1 1 2\n5\n6 8 1 2 3\n5\n2 3 1 6 8\n<b>Output:<\/b>\n3\n4\n5\n<\/pre><h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> <b>L<\/b> = 2. There are 3 different length-1 IS's.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"shangjingbo","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>shangjingbo<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"9-10-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook63'>\n                    cook63\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium'>\n                    medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/shangjingbo'>\n                    shangjingbo\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/SLIS","user":{"username":null},"time":{"view_start_date":1445193000,"submit_start_date":1445193000,"visible_start_date":1445193000,"end_date":1735669800,"current":1493556846},"todo":false,"problem_status":"unattempted"}