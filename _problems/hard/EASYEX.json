{"category_name":"hard","status":"success","problem_code":"EASYEX","problem_name":"Easy exam","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a href=\"\/download\/translated\/JULY15\/mandarin\/EASYEX.pdf\" target=\"_blank\">Mandarin Chinese <\/a> and <a href=\"\/download\/translated\/JULY15\/russian\/EASYEX.pdf\" target=\"_blank\">Russian<\/a>.<\/h3>\r\n<p>One day Chef had an exam on probability theory. Nothing interesting, but the exam was going fishily easy. And finally Chef got to the last question:<br \/><br \/> \"Suppose you have a dice with <b>K<\/b> faces with  numbers from <b>1<\/b> to <b>K<\/b> written on it, and integers <b>L<\/b> and <b>F<\/b>(<b>0 &lt; L &lt;= K<\/b>). You roll it <b>N<\/b> times. Let <b>a<sub>i<\/sub><\/b> be the number of times (out of the <b>N<\/b> rolls) that a face with number <b>i<\/b> written on it came up as the top face of the dice. Find the mathematical expectation of the value <b>a<sub>1<\/sub><sup>F<\/sup> * a<sub>2<\/sub><sup>F<\/sup> * ... * a<sub>L<\/sub><\/b><sup>F<\/sup>.\" <br \/><br \/> \"I'll drop out of university and won't be allowed to cook\" - Chef is frightened! Help him now or he will never be able to please you with tasty dishes again.<\/p>\r\n<h3>Input<\/h3>\r\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. Each of the following <b>T<\/b> lines describe one test case and contain 4 space-separated integers <b>N, K, L<\/b> and <b>F<\/b>.<\/p>\r\n<h3>Output<\/h3>\r\n<p>Let the answer for a test case be an fraction<b> P \/ Q<\/b>, where <b>P<\/b> and <b>Q<\/b> are integers. Let integer <b>X<\/b> be <b>P * Q<sup>-1<\/sup> modulo 2003<\/b>, where <b>Q<sup>-1<\/sup> modulo 2003<\/b> is the modular multiplicative inverse of <b>Q<\/b> modulo <b>2003<\/b> or <b>0<\/b> if <b>Q<sup>-1<\/sup> modulo 2003<\/b> doesn't exist. For each test case, output a single line containing the integer <b>X<\/b> for this test case.<\/p>\r\n<h3>Constraints<\/h3>\r\n<ul>\r\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>50<\/b><\/li>\r\n<li><b>0<\/b> &lt; <b>N, K<\/b> \u2264 <b>10<sup>9<\/sup><\/b><\/li>\r\n<li><b>0<\/b> &lt; <b>F \u2264 1000 <\/b><\/li>\r\n<li><b>0<\/b> &lt; <b>L * F<\/b> \u2264 <b>50 000<\/b><\/li>\r\n<li><b>Subtask #1[39 points]: F = 1<\/b> <\/li>\r\n<li><b>Subtask #2[61 points] : no additional constraints<\/b> <\/li>\r\n<\/ul>\r\n<h3>Example<\/h3>\r\n<pre><b>Input<\/b>\r\n1\r\n2 6 2 1\r\n\r\n<b>Output:<\/b>\r\n779\r\n<\/pre>\r\n<h3>Explanation<\/h3>\r\n<p>We roll the 6-face dice 2 times, and we are interested in the value  <b>a<sub>1<\/sub> * a<sub>2<\/sub><\/b>. The only two possible scenarios when this value is not zero are <b>(1, 2)<\/b> and <b>(2, 1)<\/b>. Both of them have <b>a<sub>1<\/sub> * a<sub>2<\/sub> = 1<\/b> and happen with probability <b>1 \/ 36<\/b> each. It means that <b>P \/ Q = (1 + 1) \/ 36 = 1 \/ 18<\/b>, so the answer is, <b>X = 779<\/b>.<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"5 - 20","source_sizelimit":"50000","problem_author":"pavel1996","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>pavel1996<\/span>","problem_tester":"mugurelionut","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>mugurelionut<\/span>","date_added":"13-06-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/advanced-math'>\n                    advanced-math\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>\n                    combinatorics\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/fft'>\n                    fft\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/july15'>\n                    july15\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maths'>\n                    maths\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/pavel1996'>\n                    pavel1996\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/EASYEX","user":{"username":null},"time":{"view_start_date":1436779800,"submit_start_date":1436779800,"visible_start_date":1436779800,"end_date":1735669800,"current":1493556697},"todo":false,"problem_status":"unattempted"}