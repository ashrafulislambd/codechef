
{"category_name":"hard","status":"success","problem_code":"MAXDTREE","problem_name":"Max-digit Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>###Read problems statements [Hindi](http:\/\/www.codechef.com\/download\/translated\/NOV18\/hindi\/MAXDTREE.pdf) , [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/NOV18\/vietnamese\/MAXDTREE.pdf) , [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/NOV18\/mandarin\/MAXDTREE.pdf) , [Russian](http:\/\/www.codechef.com\/download\/translated\/NOV18\/russian\/MAXDTREE.pdf) and [Bengali](http:\/\/www.codechef.com\/download\/translated\/NOV18\/bengali\/MAXDTREE.pdf) as well. \n\nYou have a tree with $N$ vertices (numbered $1$ through $N$) rooted at vertex $1$. Each vertex contains a decimal digit; let's denote the digit in vertex $i$ by $d_i$.\n\nA subtree is a non-empty subgraph satisfying the following condition: for any vertex $v$, if $v$ belongs to subtree $S$, then the parent of $v$ also belongs to $S$. Note that each subtree contains the root. The vertices in any subtree $S$ are sorted in DFS-order, i.e. using the following algorithm:\n- let's denote a *current vertex* by $c$; initially, the current vertex is the root\n- when processing vertex $c$:\n    - $c$ is the next vertex in DFS-order\n    - consider all sons of $c$ which belong to $S$, sorted in increasing order\n    - for each of these sons, change the current vertex $c$ to that son and process it recursively\n\nFor any subtree $S$ with $k$ vertices, we define the *digit string* $D(S)$ as a string with length $k$; for each valid $i$, the $i$-th character of this string is the digit in the $i$-th vertex of $S$ (in DFS-order). $D(S)$ may also be considered an integer in decimal representation.\n\nLet's define $\\mathrm{maxDigit}(x)$ as the largest decimal digit in a positive integer $x$. Consider the following infinite recurrent sequence $a$:\n- $a_1 = 1$\n- $a_n = a_{n-1} + \\mathrm{maxDigit}(a_{n-1})$ for each $n \\gt 1$\n\nFor example, the first few members of this sequence are $1, 2, 4, 8, 16, 22$.\n\nNext, let's call a subtree $S$ *good* if $D(S)$ occurs in sequence $a$. You should find the number of good subtrees of the given tree. Since this number may be large, compute it modulo $10^9 + 7$.\n\n### Input\n- The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.\n- The first line of each test case contains a single integer $N$.\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting an edge between vertices $u$ and $v$.\n- The last line contains $N$ space-separated integers $d_1, d_2, \\ldots, d_N$.\n\n### Output\nFor each test case, print a single line containing one integer \u2014 the number of good subtrees modulo $10^9 + 7$.\n\n### Constraints\n- $1 \\le T \\le 10$\n- $1 \\le N \\le 500$\n- $1 \\le u, v \\le N$\n- the graph described on the input is a tree\n- $0 \\le d_i \\le 9$ for each valid $i$\n- $d_1 \\neq 0$\n- the sum of $N$ over all test cases does not exceed $500$\n\n### Subtasks\n**Subtask #1 (20 points):** $d_i = 2$ for each valid $i$\n\n**Subtask #2 (80 points):** original constraints\n\n### Example Input\n```\n2\n3\n1 2\n2 3\n1 6 4\n5\n1 2\n1 3\n2 4\n3 5\n2 2 2 2 2\n```\n\n### Example Output\n```\n3\n6\n```\n\n### Explanation\n**Example case 1:** All valid subtrees are good (their digit strings are $1$, $16$ and $164$).\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"altruist_","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>altruist_<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"22-09-2018","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/altruist_'>altruist_<\/a>","time":{"view_start_date":1542015002,"submit_start_date":1542015002,"visible_start_date":1542015002,"end_date":1735669800,"current":1559472991},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}