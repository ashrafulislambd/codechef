{"category_name":"hard","status":"success","problem_code":"CHEFBOOK","problem_name":"Chefbook","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JUNE15\/mandarin\/CHEFBOOK.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JUNE15\/russian\/CHEFBOOK.pdf\">Russian<\/a>.<\/h3>\n\n<p>\nThe Chief Chef has built a new social network call <b>Chefbook<\/b>. Everyone who is interested in cooking can join Chefbook. Already <b>N<\/b> chefs joined the chefbook and loved it so much.\n<\/p>\n<p>\nIn Chefbook, a chef can be a friend with other chefs (one or more). The friendship is not bidirectional that means if chef <b>A<\/b> is a friend of chef <b>B<\/b>, not necessarily chef <b>B<\/b> is a friend of chef <b>A<\/b>. Every chef <b>x<\/b> in Chefbook will give a likeness value <b>L<sub>xy<\/sub><\/b> to each of his Chefbook friend <b>y<\/b>. Likeness indicates how much he like his friend.\n<\/p>\n<p>\nThe Chief Chef wants that every chef in Chefbook should have friends with moderate likeness only. He does not like the fact one chef likes another chef too much or one chef does not like another chef at all. As he is the admin of the Chefbook, he decided to change the likeness value of some chef\u2019s such that all the likeness value resides between a lower value and upper value. But changing likeness value for each friendship could be tedious and boring job. So Chief Chef comes up with a new idea. He will choose a chef <b>x<\/b> of Chefbook and increase likeness <b>L<sub>xy<\/sub><\/b> by <b>P<sub>x<\/sub><\/b> for all of his friends <b>y<\/b>. Another option is he will choose a chef <b>y<\/b> and decrease likeness <b>L<sub>xy<\/sub><\/b> by <b>Q<sub>y<\/sub><\/b> for all chef <b>x<\/b> such that <b>y<\/b> is a friend of <b>x<\/b>. The increase operation on <b>x<\/b> or decrease operation on <b>y<\/b> can be done only once. During any operation the intermediate value of <b>L<sub>xy<\/sub><\/b> can have any value but the final value of <b>L<sub>xy<\/sub><\/b> (for all <b>x<\/b> and <b>y<\/b>) should be in between <b>S<sub>xy<\/sub><\/b> and <b>T<sub>xy<\/sub> <\/b> (inclusive), where <b>S<sub>xy<\/sub><\/b> and <b>T<sub>xy<\/sub><\/b> are the lower limit and upper limit respectively of the new likeness value <b>W<sub>xy<\/sub><\/b> of chef <b>x<\/b> for his friend <b>y<\/b>.\n<\/p>\n<p>\n<b>W<sub>xy<\/sub> = L<sub>xy<\/sub> + P<sub>x<\/sub> - Q<sub>y<\/sub><\/b>\n<\/p>\n<p>\nThough Chief Chef wants to moderate the likeness value but he does not wants reduce overall likeness in Chefbook. So he decided to make the change such that sum of likeness <b>W<sub>xy<\/sub><\/b> should be as maximum as possible.\n<\/p>\n\n<h3>Input<\/h3>\n<p>The first line of input contains an integer <b>T<\/b>, denoting the number of test cases to follow.<br \/>\nThe first line of each test case contains two space separated integers <b>N<\/b> and <b>M<\/b>, denoting the number of chefs in the Chefbook and number of friend relationship in Chefbook respectively. Followed by <b>M<\/b> lines, each containing five space separated integers <b>x<\/b>, <b>y<\/b>, <b>L<sub>xy<\/sub><\/b>, <b>S<sub>xy<\/sub><\/b> and <b>T<sub>xy<\/sub><\/b>  such that <b>y<\/b> is a friend of <b>x<\/b> where <b>L<sub>xy<\/sub><\/b> is the <b>y<\/b>\u2019s likeness value given by <b>x<\/b> and <b>S<sub>xy<\/sub><\/b> and <b>T<sub>xy<\/sub><\/b> are the lower and upper limit respectively of the new likeness <b>W<sub>xy<\/sub><\/b>  set by Chief chef. Note that <b>x<\/b> and <b>y<\/b> can be same (a chef can like himself).<\/p>\n<h3>Output<\/h3>\n<p>First line of each test case will contain a single line with a single word \"<b>Unlike<\/b>\" (without the quotes) if it is not possible to change the likeness value according to the constraint described above. Otherwise each test case will consist of three lines. First line will contain a single integer <b>SUM<\/b>, which is the sum of the new likeness value <b>W<sub>xy<\/sub><\/b>. Next line will contain <b>N<\/b> space separated integers containing <b>P<sub>x<\/sub><\/b> (for all <b>x = 1<\/b> to <b>N<\/b>). Similarly next line will contain <b>N<\/b> space separated integers containing <b>Q<sub>y<\/sub><\/b> (for all <b>y = 1<\/b> to <b>N<\/b>). If there are several <b>P<\/b> and <b>Q<\/b> possible output anyone of them.<\/p>\n<p> Note that, there will be no new friendship within these operation.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1\u2264T\u226410<\/b><\/li>\n<li><b>1\u2264N\u2264100<\/b><\/li>\n<li><b>1\u2264M\u2264N<sup>2<\/sup><\/b><\/li>\n<li><b>1\u2264x, y\u2264N<\/b><\/li>\n<li><b>-600\u2264L<sub>xy<\/sub>\u2264600<\/b><\/li>\n<li><b>-1000\u2264S<sub>xy<\/sub>\u2264T<sub>xy<\/sub>\u22641000<\/b><\/li>\n<li><b>0\u2264P<sub>x<\/sub>, Q<sub>y<\/sub>\u226410<sup>6<\/sup><\/b><\/li>\n<\/ul>\n\n<h3>Subtask<\/h3>\n<p><b>Subtask #1: <\/b> Point 20<\/p>\n<ul>\n<li><b>1\u2264N\u226420<\/b><\/li>\n<\/ul>\n<p><b>Subtask #2: <\/b> Point 80<\/p>\n<ul>\n<li><b>1\u2264N\u2264100<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Sample Input<\/b>\n2\n2 4\n1 1 2 5 10\n1 2 4 8 10 \n2 1 3 5 10\n2 2 2 7 10\n2 4\n1 1 1 7 7\n1 2 7 7 7\n2 1 7 7 7\n2 2 7 7 7\n\n<b>Output for Sample Input<\/b>\n37\n15 17\n10 9\nUnlike\n\n<\/pre>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2","source_sizelimit":"50000","problem_author":"shiplu","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #1E7D22;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>2&#9733;<\/span><span>shiplu<\/span>","problem_tester":null,"problem_tester_html_handle":null,"date_added":"8-05-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/june15'>\n                    june15\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/lp'>\n                    lp\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maxflow'>\n                    maxflow\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/shiplu'>\n                    shiplu\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/CHEFBOOK","user":{"username":null},"time":{"view_start_date":1434360600,"submit_start_date":1434360600,"visible_start_date":1434360600,"end_date":1735669800,"current":1493556633},"todo":false,"problem_status":"unattempted"}