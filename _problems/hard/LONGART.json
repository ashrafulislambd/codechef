{"category_name":"hard","status":"success","problem_code":"LONGART","problem_name":"Longest Article","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>In Chefland every <b>word<\/b> contains exactly two letters. There exist two alphabets <b>A<\/b> of size <b>N<\/b> and <b>B<\/b> of size <b>M<\/b>, where the first letter of every word comes from <b>A<\/b>, and the second letter of every word comes from <b>B<\/b>.<\/p>\n<p>Every <b>sentence<\/b> is a space-separated list of words such that each letter from <b>A<\/b> is used exactly once in some word of the sentence and each letter from <b>B<\/b> is used at most once. In particular, each sentence contains exactly <b>N<\/b> words.<\/p>\n<p>An <b>article<\/b> contains exactly one sentence per line. Chef would like to avoid excessive word repetition, so he provides an upper bound for each word, specifying the number of times you can use that word in the article. Chef has no time so he asks you to write the longest possible article under the given constraints.<\/p>\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b>, denoting the number of test cases. The description of <b>T<\/b> test cases follows. The first line of each test contains an integer <b>N<\/b> and a string <b>A<\/b> of length <b>N<\/b>, denoting the first alphabet. <b>N<\/b> and <b>A<\/b> are separated by exactly one space. The next line contains an integer <b>M<\/b> and a string <b>B<\/b> of length <b>M<\/b>, denoting the second alphabet. <b>M<\/b> and <b>B<\/b> are separated by exactly one space. Then <b>N * M<\/b> lines follow. Each of these lines contains two-character string <b>W<\/b> and an integer <b>C(W)<\/b>, denoting the word and the upper bound on the number of times this word can be used in the article. They are separated by exactly one space.<\/p>\n<h3>Output<\/h3>\n<p>For each test case, output on a separate line an integer <b>K<\/b> denoting the number of sentences in the longest possible article, followed by the longest article in compressed format on consecutive lines. The first line of the compressed article should contain an integer <b>L<\/b>, denoting the number of blocks in the article. Each of following <b>L<\/b> lines should contain an integer <b>R<\/b> and a sentence <b>S<\/b> separated by a space. It means that in the actual article, <b>R<\/b> sentences equal to <b>S<\/b> follows. If <b>every<\/b> longest possible article requires more than <b>30000<\/b> blocks in its compressed form, output <b>-1<\/b> instead of the compressed article. If there are several longest articles possible you can output any of them.<\/p>\n<h3>Constraints<\/h3>\n<p>\n<ul>\n<li><b>1<\/b> &le; <b>T<\/b> &le; <b>2<\/b><\/li>\n<li><b>1<\/b> &le; <b>N, M<\/b> &le; <b>94<\/b><\/li>\n<li><b>0<\/b> &le; <b>C(W)<\/b> &le; <b>10000000<\/b> (<b>10<sup>7<\/sup><\/b>)<\/li>\n<li>All characters in <b>A<\/b> are different and <b>A<\/b> contains exactly <b>N<\/b> characters<\/li>\n<li>All characters in <b>B<\/b> are different and <b>B<\/b> contains exactly <b>M<\/b> characters<\/li>\n<li>Each character in <b>A<\/b> and <b>B<\/b> has ASCII code from 33 to 126, inclusive.<\/li>\n<li>The first character of <b>W<\/b> is from <b>A<\/b> and the second one is from <b>B<\/b><\/li>\n<li>All <b>N * M<\/b> words in the input for the particular test case are different<\/li>\n<\/ul>\n<\/p>\n<h3>Example<\/h3>\n<pre>\n<b>Input:<\/b>\n2\n2 Hi\n3 esn\nis 1\nHs 1\nHn 2\nie 2\nin 1\nHe 2\n1 +\n1 +\n++ 0\n\n<b>Output:<\/b>\n4\n3\n1 He is\n1 in He \n2 Hn ie\n0\n0\n<\/pre><h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> The complete article is<br\/>He is<br\/>in He<br\/>Hn ie<br\/>Hn ie<br\/>Note that we use each word maximum number of times except <b>Hs<\/b> which was not used at all.<\/br\/><\/br\/><\/br\/><\/br\/><\/br\/><\/p>\n<p><b>Example case 2.<\/b> We have only 1 word <b>++<\/b> for the given alphabets <b>A<\/b> and <b>B<\/b> but Chef does not allow to use it. So the only possible article here is an empty article.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"2.5","source_sizelimit":"50000","problem_author":"iscsi ","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>iscsi<\/span>","problem_tester":"anton_lunyov","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>anton_lunyov<\/span>","date_added":"30-11-2012","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/bipartite'>\n                    bipartite\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/graph'>\n                    graph\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/iscsi '>\n                    iscsi \n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/march13'>\n                    march13\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maximum-flow'>\n                    maximum-flow\n                <\/a>","user":{"username":null},"time":{"view_start_date":1363000137,"submit_start_date":1363000137,"visible_start_date":1363000099,"end_date":1735669800,"current":1493556759},"todo":false,"problem_status":"unattempted"}