{"category_name":"hard","status":"success","problem_code":"COT5","problem_name":"Count on a Treap","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB14\/mandarin\/COT5.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/FEB14\/russian\/COT5.pdf\">Russian<\/a>.<\/h3>\n<p>In computer science, a treap is a binary search tree according to the keys and meanwhile a heap according to the weights. Follow the link for more details: <a href=\"http:\/\/en.wikipedia.org\/wiki\/Treap\" title=\"http:\/\/en.wikipedia.org\/wiki\/Treap\">http:\/\/en.wikipedia.org\/wiki\/Treap<\/a><\/p>\n<p>Your task is to maintain a <b>max-treap<\/b> supporting the following operations:<\/p>\n<ul>\n<li>0 <b>k w<\/b>: Insert a new node, whose key and weight are <b>k<\/b> and <b>w<\/b>.<\/li>\n<li>1 <b>k<\/b>: Delete a node in the treap with key <b>k<\/b>.<\/li>\n<li>2 <b>ku<\/b> <b>kv<\/b>: Return the distance between node\u00a0<b>u<\/b> whose key is <b>ku<\/b> and node\u00a0<b>v<\/b> whose key is <b>kv<\/b>.<\/li>\n<\/ul>\n<p><br \/><br \/>\nNo two nodes share the same key or the same weight in the tree, and we guarantee the node is indeed in the treap before a delete operation takes place.<\/p>\n<p><br \/><\/p>\n<h3>Input<\/h3>\n<p>The first line contains an integer <b>N<\/b>, the number of operations.<br \/>\nEach of the next <b>N<\/b> lines contains two or three integers \"<b>0 k w<\/b>\" \"<b>1 k<\/b>\" or \"<b>2 ku kv<\/b>\u201d . These integers describe the current operation.<\/p>\n<p><br \/><\/p>\n<h3>Output<\/h3>\n<p>For each distance query, print the distance between <b>u<\/b> and <b>v<\/b>.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1 \u2264 N \u2264 200000<\/b><\/li>\n<li><b>0 &lt; k, w, ku, kv  &lt; 2<sup>32<\/sup><\/b><\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><strong>Input:<\/strong>\n12\n0 4 17535\n0 10 38964\n0 2 21626\n0 1 61321\n2 1 10\n2 10 4 \n1 10\n1 1\n0 8 42634\n2 8 4\n2 8 2\n2 4 2\n\n<strong>Output:<\/strong>\n1\n2\n2\n1\n1\n<\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"xiaodao","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>xiaodao<\/span>","problem_tester":"laycurse","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>laycurse<\/span>","date_added":"12-12-2013","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/feb14'>\n                    feb14\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/treap'>\n                    treap\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/xiaodao'>\n                    xiaodao\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/COT5","user":{"username":null},"time":{"view_start_date":1392629400,"submit_start_date":1392629400,"visible_start_date":1392629400,"end_date":1735669800,"current":1493556669},"todo":false,"problem_status":"unattempted"}