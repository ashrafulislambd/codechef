{"category_name":"hard","status":"success","problem_code":"CONNECT","problem_name":"Find a special connected block","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>\nGiven an <b>n<\/b>*<b>m<\/b> board with a number between -1 and <b>n<\/b>*<b>m<\/b> in every entries.\n\n<\/p><p>And an <b>n<\/b>*<b>m<\/b> matrix <b>M<\/b> is also given, where <b>M<\/b><sub>i,j<\/sub> is the cost of selecting the <i>(i,j)<\/i> entry of the given board.\n\n<\/p><p>Your task is to find a connected block (which means these entries can reach each other by just go up, down, left and right without going out the block) in the board that contains at least <b>K<\/b> distinct positive numbers without any -1, and it must have minimum total cost for selecting these entries. Output the minimum total cost.\n\n<h3>Input<\/h3>\n<\/p><p>First line consists of three integers, <b>n<\/b>, <b>m<\/b>, <b>K<\/b> (1 &lt;= <b>n<\/b>, <b>m<\/b> &lt;= 15, 1 &lt;= <b>K<\/b> &lt;= 7).\n\n<\/p><p>The followings are two <b>n<\/b>*<b>m<\/b> matrices, the first denotes the numbers on the board and the second denotes the cost of every entry.\n\n<\/p><p>Namely, the first <b>n<\/b> lines contain <b>m<\/b> integers, where the <i>j<\/i>th number in <i>i<\/i>th line denotes the number on the entry (<i>i<\/i>,<i>j<\/i>) of the board. These integers are in [-1, <b>n<\/b>*<b>m<\/b>].\n\n<\/p><p>Next <b>n<\/b> lines contain <b>m<\/b> integers too. The <i>j<\/i>th number in <i>i<\/i>th line denotes the cost of selecting the entry (<i>i<\/i>,<i>j<\/i>) of the board. These integers are in [1, 100000].\n\n<h3>Output<\/h3>\n<\/p><p>\nOnly one line contains the minimum cost to finish the task. If the task is impossible, output -1 please.\n<h3>Example<\/h3>\n\n<pre>\n<b>Input:<\/b>\n3 3 3\n0 0 1 \n2 3 3 \n-1 2 1 \n3 1 5 \n4 10 1 \n9 3 4 \n<b>Output:<\/b>\n8\n<\/pre><\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"7","source_sizelimit":"50000","problem_author":"shangjingbo","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>shangjingbo<\/span>","problem_tester":"laycurse","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>laycurse<\/span>","date_added":"28-02-2012","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/april12'>\n                    april12\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/shangjingbo'>\n                    shangjingbo\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/CONNECT","user":{"username":null},"time":{"view_start_date":1334137565,"submit_start_date":1334137565,"visible_start_date":1334136600,"end_date":1735669800,"current":1493556662},"todo":false,"problem_status":"unattempted"}