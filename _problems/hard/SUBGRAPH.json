{"category_name":"hard","status":"success","problem_code":"SUBGRAPH","problem_name":"Counting Subgraphs","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3>Read problems statements in <a href=\"\/download\/translated\/COOK62\/mandarin\/SUBGRAPH.pdf\" target=\"_blank\">Mandarin Chinese<\/a> and <a href=\"\/download\/translated\/COOK62\/russian\/SUBGRAPH.pdf\" target=\"_blank\">Russian<\/a> as well.<\/h3>\r\n<p>\r\n<meta charset=\"utf8\" \/>\r\n<\/p>\r\n<p>Kostya recently began his internship in a very big and famous IT company. His first project is dedicated to visualization of graphs, but his manager wanted to make sure Kostya is good enough for this project before he starts writing any code. As it usually goes, Kostya was given an algorithmic problem and was asked to come up with a solution. After struggling with the problem for a couple of days, he finally managed to solve it. Now Kostya wants to challenge the participants of the September Cook-Off 2015 Contest with this problem. Unfortunately, you don't have a couple of days to solve it, and you'll have to make do with 2.5 hours. Are you ready to be challenged? :)<\/p>\r\n<p>You are given an undirected graph <b>G<\/b> of <b>N<\/b> nodes and <b>M<\/b> edges. The nodes of <b>G<\/b> are labeled with unique integer numbers of the range [1, 2, ... , <b>N<\/b>]. It's guaranteed that no multiple edges or self-loops appear in the graph as well as that the graph is connected. There's one more restriction on the graph: any node of <b>G<\/b> belongs to at most one simple cycle in <b>G<\/b>.<\/p>\r\n<p>Your task is to count the subsets of nodes in <b>G<\/b>, such that the nodes in the subset are connected (you can reach any node of the subset from any other node of the subset only by moving to adjacent nodes that belong to the subset) and contain no more than <b>K<\/b> nodes. Since the answer may exceed the limits of usual primitive integer types, you are asked to do all the calculations modulo 10<sup>9<\/sup> + 7.<\/p>\r\n<h3>Input<\/h3>\r\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/p>\r\n<p>The first line of a test case description contains three integers <b>N<\/b>, <b>M<\/b> and <b>K<\/b>.<\/p>\r\n<p>Each of the next <b>M<\/b> lines contains two integers <b>U<\/b> and <b>V<\/b> denoting a single edge in <b>G<\/b> between the vertices labeled <b>U<\/b> and <b>V<\/b>.<\/p>\r\n<h3>Output<\/h3>\r\n<p>For each test case, output a single line containing one integer: the number of described subsets modulo 10<sup>9<\/sup> + 7.<\/p>\r\n<h3>Constraints<\/h3>\r\n<ul>\r\n<li>1 \u2264 <b>T<\/b> \u2264 10<\/li>\r\n<li>1 \u2264 <b>N<\/b> \u2264 5000<\/li>\r\n<li>0 \u2264 <b>M<\/b> \u2264 10000<\/li>\r\n<li>1 \u2264 <b>K<\/b> \u2264 min(<b>N<\/b>, 30)<\/li>\r\n<li>1 \u2264 <b>U<\/b> \u2260 <b>V<\/b> \u2264 <b>N<\/b><\/li>\r\n<li>The size of any simple cycle in <b>G<\/b> does not exceed <b>L<\/b> = 50<\/li>\r\n<\/ul>\r\n<h3>Example<\/h3>\r\n<pre><b>Input:<\/b>\r\n3\r\n3 2 1\r\n2 1\r\n3 1\r\n5 5 4\r\n5 4\r\n4 3\r\n1 5\r\n3 2\r\n2 5\r\n3 2 2\r\n2 3\r\n1 3\r\n\r\n<b>Output:<\/b>\r\n3\r\n20\r\n5\r\n\r\n<\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.4, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"10","source_sizelimit":"50000","problem_author":"kostya_by","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #D0011B;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>7&#9733;<\/span><span>kostya_by<\/span>","problem_tester":"shangjingbo","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>shangjingbo<\/span>","date_added":"25-07-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/cook62'>\n                    cook62\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/dynamic-programming'>\n                    dynamic-programming\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/graph'>\n                    graph\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/kostya_by'>\n                    kostya_by\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/tree'>\n                    tree\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/SUBGRAPH","user":{"username":null},"time":{"view_start_date":1442773800,"submit_start_date":1442773800,"visible_start_date":1442773800,"end_date":1735669800,"current":1493556860},"todo":false,"problem_status":"unattempted"}