{"category_name":"hard","status":"success","problem_code":"XETF","problem_name":"Euler Totient Function Extended","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME23\/mandarin\/XETF.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/LTIME23\/russian\/XETF.pdf\">Russian<\/a>.<\/h3>\n<p>Euler totient function (denoted by <b>phi(N)<\/b>) for a positive integer <b>N<\/b> is defined as number of positive integers less than or equal  <b>N<\/b> that are coprime to <b>N<\/b><\/p>\n<p>Let's generalize this concept of Euler totient function. For positive integer <b>N<\/b> let's write out the integers that are less than or equal to <b>N<\/b> and are coprime to <b>N<\/b>. We'll get a list of integers of the form <b>A<sub>1<\/sub>, A<sub>2<\/sub>, ..., A<sub>M<\/sub><\/b>, where <b>M = phi(N)<\/b>. Let's denote <b>E<sub>K<\/sub>(N) = A<sub>1<\/sub><sup>K<\/sup> + A<sub>2<\/sub><sup>K<\/sup>+...+A<sub>M<\/sub><sup>K<\/sup><\/b>. This way we obtain something more general version of Euler totient function, in particular, <b>E<sub>0<\/sub>(N) = phi(N)<\/b> for every positive integer <b>N<\/b>.<\/p>\n<p>Your task is to calculate <b>E<sub>K<\/sub>(N)<\/b>. As answer could be large, print your answer modulo <b>10<sup>9<\/sup>+7<\/b> <\/p>\n<h3>Input<\/h3>\n<p> The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/p>\n<p>The first line of each test case contains two space separated integers <b>N<\/b> and <b>K<\/b>.<\/p>\n<h3>Output<\/h3>\n<p>For each test case, output a single line containing the answer to the problem i.e. the value of <b>E<sub>K<\/sub>(N)<\/b> modulo <b>10<sup>9<\/sup>+7<\/b>.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<p>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>128<\/b><\/li>\n<\/p>\n<\/ul>\n<p>Subtask 1 (7 points):<\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10<sup>4<\/sup><\/b><\/li>\n<li><b>0<\/b> \u2264 <b>K<\/b> \u2264 <b>10<sup>4<\/sup><\/b><\/li>\n<\/ul>\n\n<p>Subtask 2 (10 points):<\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10<sup>12<\/sup><\/b><\/li>\n<li><b>K<\/b> = <b>0<\/b><\/li>\n<\/ul>\n\n<p>Subtask 3 (28 points):<\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10<sup>12<\/sup><\/b><\/li>\n<li><b>K<\/b> = <b>1<\/b><\/li>\n<\/ul>\n\n<p>Subtask 4 (55 points):<\/p>\n<ul>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>10<sup>12<\/sup><\/b><\/li>\n<li><b>0<\/b> \u2264 <b>K<\/b> \u2264 <b>256<\/b><\/li>\n<\/ul>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n10 1\n7 0\n\n<b>Output:<\/b>\n20\n6\n<\/pre><h3>Explanation<\/h3>\n<p><b>Example case 1.<\/b> The numbers that are coprime to <b>10<\/b> are <b>1, 3, 7, 9<\/b>. Their sum is <b>20<\/b>.<\/p>\n<p><b>Example case 2.<\/b> <b>7<\/b> is a prime number, so any integer that is less than <b>7<\/b> is coprime to it.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL","max_timelimit":"4 - 6","source_sizelimit":"50000","problem_author":"xcwgf666","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>xcwgf666<\/span>","problem_tester":"karanaggarwal","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #684273;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>4&#9733;<\/span><span>karanaggarwal<\/span>","date_added":"21-03-2015","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/easy-medium'>\n                    easy-medium\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/inclusn-exclusn'>\n                    inclusn-exclusn\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/ltime23'>\n                    ltime23\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/xcwgf666'>\n                    xcwgf666\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/XETF","user":{"username":null},"time":{"view_start_date":1430037000,"submit_start_date":1430037000,"visible_start_date":1430037000,"end_date":1735669800,"current":1493556901},"todo":false,"problem_status":"unattempted"}