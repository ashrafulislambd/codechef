
{"category_name":"hard","status":"success","problem_code":"XDCOMP","problem_name":"Xor Decomposition","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/FEB19TST\/hindi\/XDCOMP.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/FEB19TST\/bengali\/XDCOMP.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/FEB19TST\/mandarin\/XDCOMP.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/FEB19TST\/russian\/XDCOMP.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/FEB19TST\/vietnamese\/XDCOMP.pdf) as well.\n\nChef has a tree with $N$ nodes (numbered $1$ through $N$) and a non-negative integer $x$. The nodes of the tree have non-negative integer weights; let's denote the weight of node $i$ by $a_i$.\n\nNext, let's define the *XOR value* of a tree as the bitwise XOR of weights of all its nodes.\n\nChef wants to remove zero or more edges from his tree in such a way that each individual tree in the forest formed by removing these edges has XOR value $x$. Help him compute the number of ways to remove a set of edges such that this condition is satisfied. Since the answer may be large, compute it modulo $10^9+7$.\n\n### Input\n- The first line of the input contains two space-separated integers $N$ and $x$.\n- The second line contains $N$ space-separated integers $a_1, a_2, \\ldots, a_N$.\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting an edge between nodes $u$ and $v$ in Chef's tree.\n\n### Output\nPrint a single line containing one integer \u2015 the number of ways to remove edges, modulo $10^9+7$.\n\n### Constraints \n- $1 \\le N \\le 10^5$\n- $0 \\le x \\le 10^9$\n- $0 \\le a_i \\le 10^9$ for each valid $i$\n- $1 \\le u, v \\le N$\n\n### Subtasks\n**Subtask #1 (10 points):** $N \\le 100$\n\n**Subtask #2 (20 points):** $N \\le 5,000$\n\n**Subtask #3 (70 points):** original constraints\n\n### Example Input\n```\n7 1\n1 0 1 0 1 0 1 \n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n```\n\n### Example Output\n```\n5\n```\n\n### Explanation\nThere are five valid ways to remove edges, splitting the tree into subtrees on nodes:\n- [1, 2, 3, 4, 5, 6] and [7] by removing the edge (3-7)\n- [1, 2, 3, 4, 6, 7] and [5] by removing the edge (2-5)\n- [2, 4, 5] and [1, 3, 6, 7] by removing the edge (1-2)\n- [2, 4, 5], [1], [3,6] and [7] by removing edges (1-2), (1-3) and (3-7)\n- [1, 2, 4], [5], [3,6] and [7] by removing edges (2-5), (1-3) and (3-7)\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"1","source_sizelimit":"50000","problem_author":"stevens","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>stevens<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"24-01-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/combinatorics'>combinatorics<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/feb19'>feb19<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/medium'>medium<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/observations'>observations<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/stevens'>stevens<\/a>, <a class='problem-tag-small ' href='\/tags\/problems\/tree-dp'>tree-dp<\/a>","editorial_url":"https:\/\/discuss.codechef.com\/problems\/XDCOMP","time":{"view_start_date":1550050202,"submit_start_date":1550050202,"visible_start_date":1550050202,"end_date":1735669800,"current":1559472994},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}