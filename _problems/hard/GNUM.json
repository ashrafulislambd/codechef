{"category_name":"hard","status":"success","problem_code":"GNUM","problem_name":"Game of Numbers","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JULY14\/mandarin\/GNUM1.pdf\">Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/JULY14\/russian\/GNUM.pdf\">Russian<\/a>.<\/h3>\n\n<p>Mr. Yagami is playing a game of numbers. He has two arrays, each of size <b>N<\/b> denoted by <b>A<sub>1<\/sub>,A<sub>2<\/sub>...A<sub>N<\/sub><\/b> and <b>B<sub>1<\/sub>,B<sub>2<\/sub>...B<sub>N<\/sub><\/b>.<\/p>\n<p>Now, he has to make a move each minute. Let us maintain two sets <b>S1<\/b> and <b>S2<\/b> which are empty intially.\nIn one move , first he'll pick a pair of indexes <b>(i, j)<\/b> such that it's already not present in <b>S1<\/b>. Also, <b>B<sub>j<\/sub> > A<sub>i<\/sub><\/b> and <b>GCD(A<sub>i<\/sub>,B<sub>j<\/sub>)<\/b> is not <b>1<\/b>. Further, he'll pick another pair of indices <b>(p, q)<\/b> such that it's already not present in <b>S2<\/b>. Also, <b>B<sub>p<\/sub> &lt; A<sub>q<\/sub><\/b> and <b>GCD(A<sub>q<\/sub>,B<sub>p<\/sub>)<\/b> is not <b>1<\/b>. Also, <b>GCD(A<sub>q<\/sub>,B<sub>p<\/sub>)<\/b> should not be coprime to <b>GCD(A<sub>i<\/sub>,B<sub>j<\/sub>)<\/b>. And, he'll add both pair of indices to <b>S1<\/b> and <b>S2<\/b>, respectively.\n\n<p>Help Mr. Yagami by printing the largest number of moves he can perform.<\/p>\n\n<h3>Input<\/h3>\n<p>First line contain <b>T<\/b>, the number of testcases. Each testcase consists of <b>N<\/b> in one line, followed by two lines of <b>N<\/b> space separated integers each, denoting arrays <b>A<\/b> and <b>B<\/b>, respectively.<\/p>\n\n<h3>Output<\/h3>\n<p>For each testcase, print the maximum number of moves Mr. Yagami can make, in one line.<\/p>\n\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>10<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>400<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>A<sub>i<\/sub>, B<sub>i<\/sub><\/b> \u2264 <b>10<sup>9<\/sup><\/b><\/li>\n<\/ul>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n4\n2 5 6 14\n3 4 7 10\n2\n2 3\n5 7\n\n<b>Output:<\/b>\n3\n0\n\n<\/pre>\n<h3>Explanation<\/h3>\n<p>\nFirst testcase:<br\/>\nFollowing are the possible moves denoting by (i,j) and (p,q)<br\/>\n1st move: (1,2) and (2,3)<br\/>\n2nd move: (1,4) and (2,4)<br\/>\n3rd move: (3,4) and (4,4)<br\/>\nIn any possible combination not more than 3 moves are possible.<br\/>\n<br\/>\nSecond testcase:<br\/>\nNo move is possible.<br\/>\n<\/p>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"darkshadows","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FFBF00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>5&#9733;<\/span><span>darkshadows<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"23-05-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/darkshadows'>\n                    darkshadows\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/july14'>\n                    july14\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maths'>\n                    maths\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/maxflow'>\n                    maxflow\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/GNUM","user":{"username":null},"time":{"view_start_date":1405330200,"submit_start_date":1405330200,"visible_start_date":1405330200,"end_date":1735669800,"current":1493556718},"todo":false,"problem_status":"unattempted"}