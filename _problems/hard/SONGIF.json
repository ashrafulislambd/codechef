
{"category_name":"hard","status":"success","problem_code":"SONGIF","problem_name":"Sonya and Gifts","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/MAY19\/hindi\/SONGIF.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/MAY19\/bengali\/SONGIF.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/MAY19\/mandarin\/SONGIF.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/MAY19\/russian\/SONGIF.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/MAY19\/vietnamese\/SONGIF.pdf) as well.\n\nSonya lives in a magical land which consists of $N$ cities (numbered $1$ through $N$) and $N - 1$ roads connecting them. In other words, the country where Sonya lives is a tree.\n\nThe country is magical because toys of an infinite number of types are made there. The types of toys are labeled by all integers and in each city, there is a toy store which sells an infinite number of toys of each type.\n\nSome stores make better toys of some types than other stores. For each valid $i$ and each integer $j$, the *quality* of any toy with type $j$ in the store in city $i$ is $K_i \\cdot j + B_i$, where $K_i$ and $B_i$ are parameters of this store.\n\nSonya loves to buy toys from the magical land as gifts for her friends. She knows what types of toys her friends like. Therefore, she sometimes decides that she wants to buy a toy with some type $z$, travels along the shortest path between some cities $u$ and $v$ and buys one toy with the chosen type $z$. Obviously, she wants this toy to have the maximum possible quality among all toys with this type found in stores on this path (including stores in cities $u$ and $v$), so she needs to know this maximum quality.\n\nAlso, sometimes, there are new reforms in the magical land, which change the parameters of some stores. In each reform, the shortest path between two cities $u$ and $v$ is chosen, along with two parameters $x$ and $y$. Then, for each city $c$ on this path (including $u$ and $v$), $K_c$ is increased by $x$ and $B_c$ is increased by $y$.\n\nYour task is to process $Q$ queries of two types:\n1. $u$, $v$, $x$, $y$: There is a new reform.\n2. $u$, $v$, $z$: Sonya wants to know the maximum of qualities of toys with type $z$ sold on the simple path between cities $u$ and $v$.\n\n### Input\n- The first line of the input contains two space-separated integers $N$ and $Q$.\n- The second line contains $N$ space-separated integers \u2014 the initial values of $K_1, K_2, \\ldots, K_N$.\n- The third line contains $N$ space-separated integers \u2014 the initial values of $B_1, B_2, \\ldots, B_N$.\n- Each of the following $N-1$ lines contains two space-separated integers $u$ and $v$ denoting that cities $u$ and $v$ are connected by a road.\n- The next $Q$ lines describe queries.\n    - Each of these lines starts with three space-separated integers $t$, $u$ and $v$, where $t$ denotes the type of the current query.\n    - If $t = 1$, this is followed by a space and two space-separated integers $x$ and $y$.\n    - If $t = 2$, this is followed by a space and one integer $z$.\n\n### Output\nFor each query of the second type, print a single line containing one integer \u2014 the maximum possible quality of a toy Sonya can buy.\n\n### Constraints \n- $1 \\le N, Q \\le 10^5$\n- $1 \\le u, v \\le N$\n- $|K_i| \\le 10^8$ for each valid $i$\n- $|B_i| \\le 10^{16}$ for each valid $i$\n- $|x| \\le 10^4$\n- $|y|, |z| \\le 10^9$\n- $1 \\le t \\le 2$\n- the graph described on the input is a tree\n\n### Subtasks\n**Subtask #1 (11 points):** $1 \\le N, Q \\le 5,000$\n\n**Subtask #2 (36 points):** each city is directly connected to at most two other cities\n\n**Subtask #3 (53 points):** original constraints\n\n### Example Input\n```\n6 6\n1 2 1 3 3 -1\n-1 -5 -4 6 8 -14\n3 4\n2 1\n2 3\n6 4\n3 5\n2 1 5 -20\n1 4 5 -7 4\n2 3 6 -5\n2 1 3 3\n1 2 4 -1 20\n2 6 2 8\n```\n\n### Example Output\n```\n-21\n30\n2\n23\n```\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, R, COB, FS","max_timelimit":"4","source_sizelimit":"50000","problem_author":"smelskiy","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>smelskiy<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"27-04-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/smelskiy'>smelskiy<\/a>","time":{"view_start_date":1557739980,"submit_start_date":1557739980,"visible_start_date":1557739980,"end_date":1735669800,"current":1559472994},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}