
{"category_name":"hard","status":"success","problem_code":"SONATR","problem_name":"Sonya and Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span>### Read problem statements in [Hindi](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/hindi\/SONATR.pdf), [Bengali](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/bengali\/SONATR.pdf), [Mandarin Chinese](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/mandarin\/SONATR.pdf), [Russian](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/russian\/SONATR.pdf), and [Vietnamese](http:\/\/www.codechef.com\/download\/translated\/MAR19TST\/vietnamese\/SONATR.pdf) as well.\n\nSonya is a very smart girl, so Danya wants to give her something interesting. He thought about it for a long time and decided that the best gift would be a tree. This tree has $N$ vertices (numbered $1$ through $N$); of course, it is a connected graph with $N-1$ edges connecting those vertices.\n\nDanya realised that an ordinary tree probably would not surprise Sonya. Therefore, he decided to place integers $0$ through $N-1$ into the tree in such a way that each vertex contains exactly one integer and each of these integers appears in exactly one vertex. For each valid $i$, let's denote the integer placed in vertex $i$ by $p_i$.\n\nThe *beauty* of a tree is defined as the number of beautiful simple undirected paths in it. A path with length $L$ (containing $L$ vertices; possibly $L=1$) is *beautiful* if for each $i$ ($0 \\le i \\le L-1$), there is a vertex $v$ on this path such that $p_v = i$.\n\nDanya doubts that this is the most beautiful tree, so he wants to perform $M$ operations. In each operation, he selects two (not necessarily distinct) vertices $u$ and $v$ and swaps $p_u$ with $p_v$. After each operation, he would like to know the current beauty of the tree. Please help him compute it so that he can decide when the tree will be the best gift for Sonya.\n\n### Input\n- The first line of the input contains a single integer $N$.\n- The second line contains $N$ space-separated integers $p_1, p_2, \\ldots, p_N$ denoting the integers initially placed in the tree.\n- Each of the next $N - 1$ lines contains two space-separated integers $u$ and $v$ denoting an edge between vertices $u$ and $v$.\n- The next line contains a single integer $M$.\n- Each of the next $M$ lines contains two space-separated integers $u$ and $v$ describing one operation.\n\n### Output\nFor each operation, print a single line containing one integer -  the beauty of the tree after this operation.\n\n### Constraints \n- $1 \\le N, M \\le 5 \\cdot 10^5$\n- $0 \\le p_i \\le N - 1$ for each valid $i$\n- $1 \\le u, v \\le N$\n\n### Subtasks\n**Subtask #1 (33 points):** Degree of each vertex is at most 2\n\n**Subtask #2 (67 points):** original constraints \n\n### Example Input\n```\n5 \n2 0 1 3 4\n2 4\n1 2\n5 2\n1 3\n4\n2 1\n5 5\n3 4\n3 2\n```\n\n### Example Output\n```\n4\n4\n3\n2\n```\n","languages_supported":"C, CPP14, JAVA, PYTH, PYTH 3.6, PYPY, CS2, PAS fpc, PAS gpc, RUBY, PHP, GO, NODEJS, HASK, rust, SCALA, swift, D, PERL, FORT, WSPC, ADA, CAML, ICK, BF, ASM, CLPS, PRLG, ICON, SCM qobi, PIKE, ST, NICE, LUA, BASH, NEM, LISP sbcl, LISP clisp, SCM guile, JS, ERL, TCL, kotlin, PERL6, TEXT, SCM chicken, PYP3, CLOJ, COB, FS","max_timelimit":"3","source_sizelimit":"50000","problem_author":"smelskiy","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>smelskiy<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"31-01-2019","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/smelskiy'>smelskiy<\/a>","time":{"view_start_date":1552469402,"submit_start_date":1552469402,"visible_start_date":1552469402,"end_date":1735669800,"current":1559472992},"user":{"username":"","access":"default"},"todo":false,"problem_status":"unattempted","is_direct_submittable":false}