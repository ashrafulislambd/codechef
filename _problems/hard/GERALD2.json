{"category_name":"hard","status":"success","problem_code":"GERALD2","problem_name":"Black and White Tree","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV13\/mandarin\/GERALD2.pdf\"> Mandarin Chinese <\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/NOV13\/russian\/GERALD2.PDF\"> Russian<\/a>.<\/h3>\n<p>Chef has a rooted tree, consisting of <b>N<\/b> vertexes. Each tree vertex has a unique index (integer from <b>1<\/b> to <b>N<\/b>), and also has a color (black or white).<br \/>\nThe root of Chef's tree has index <b>1<\/b>.<\/p>\n<p>Initially, all vertexes of the tree are colored white. Then Chef start playing with the tree. He writes out a sequence of<br \/>\n<b>M<\/b> vertexes of the tree <b>V<sub>1<\/sub><\/b>, <b>V<sub>2<\/sub><\/b>, ..., <b>V<sub>M<\/sub><\/b>. And now he wants to make <b>M<\/b> operations with the tree, each of them is:<\/p>\n<p><ol>\n<li>During <b>i<\/b>-th operation Chef picks vertex <b>V<sub>i<\/sub><\/b>.<\/li>\n<li>If vertex <b>V<sub>i<\/sub><\/b> is black, then he colors it white.<\/li>\n<li>Chef finds the farthest white vertex from vertex <b>V<sub>i<\/sub><\/b>, in case of tie he picks the one with largest index. This vertex is the result of current operation.<\/li>\n<li>If vertex <b>V<sub>i<\/sub><\/b> wasn't recolored on step 2 of current operation (therefore before the operation it is white), Chef colors it black.<\/li>\n<\/ol>\n<\/p>\n<p>Chef gives to you the tree and sequence <b>V<\/b>. Help him to make all the operations. So, print the index of resulting vertex for each operation.\n<\/p>\n<h3>Input<\/h3>\n<p>The first line of the input contains an integer <b>T<\/b> denoting the number of test cases. The description of <b>T<\/b> test cases follows.<\/p>\n<p>The first line of each test case contains two integers <b>N<\/b>, <b>M<\/b> - the number of vertexes of the tree and the number of operations.<br \/>\nThe second line contains <b>N-1<\/b> integers <b>P<sub>2<\/sub><\/b>, <b>P<sub>3<\/sub><\/b>, ..., <b>P<sub>N<\/sub><\/b> - description of Chef's tree.<br \/>\nInteger <b>P<sub>i<\/sub><\/b> denotes the index of vertex that is parent of the vertex <b>i<\/b> in the tree.<br \/>\nEach of the next <b>M<\/b> lines contains the description of operations, <b>i<\/b>-th of them contains integer <b>V<sub>i<\/sub><\/b>.<\/p>\n<p>It is guaranteed that the given graph is a tree.<\/p>\n\n<h3>Output<\/h3>\n<p>For each operation of each test case print the index of resulting vertex on the separate line.<\/p>\n<h3>Constraints<\/h3>\n<p><\/p><p><b>1<\/b> \u2264 <b>T<\/b> \u2264 <b>1000<\/b>,<\/p>\n<p><b>2<\/b> \u2264 <b>N<\/b> \u2264 <b>200000<\/b>,<\/p>\n<p><b>1<\/b> \u2264 <b>M<\/b> \u2264 <b>200000<\/b>,<\/p>\n<p><b>1<\/b> \u2264 <b>P<sub>i<\/sub><\/b>, <b>V<sub>i<\/sub><\/b> \u2264 <b>N<\/b>;<\/p>\n<p>Sum of all <b>N<\/b> values for test cases is not greater than <b>200000<\/b>.<\/p>\n<p>Sum of all <b>M<\/b> values for test cases is not greater than <b>200000<\/b>.<\/p>\n\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\n6 7\n3 1 3 4 4\n1\n5\n6\n1\n3\n5\n2\n2 2\n1\n2\n1\n\n<b>Output:<\/b>\n6\n2\n2\n4\n4\n2\n5\n1\n1\n<\/pre>","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"gerald","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>gerald<\/span>","problem_tester":null,"problem_tester_html_handle":"","date_added":"8-10-2013","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/data-structure'>\n                    data-structure\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/gerald'>\n                    gerald\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/heavy-light'>\n                    heavy-light\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/nov13'>\n                    nov13\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/GERALD2","user":{"username":null},"time":{"view_start_date":1384162200,"submit_start_date":1384162200,"visible_start_date":1384162200,"end_date":1735669800,"current":1493556718},"todo":false,"problem_status":"unattempted"}