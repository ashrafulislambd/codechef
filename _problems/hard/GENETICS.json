{"body":"\n<h3> All submissions for this problem are available. <\/h3><p>Genetic engineering is fun. The scientists have gathered several DNAs and want to create something new out of those. Each DNAs can be represented as a sequence of bases A, G, T, C. Let DNA[a..b] be the subsequence of DNA starting from index a finishing in b inclusive, and DNA[a..] be the subsequence of DNA starting from index a to the end. Scientist can perform the following operations on the DNAs:<\/p>\n<ul>\n<li>cross operation     they take DNA1 and DNA2 and numbers k1 and k2. Then two new DNAs are created: DNA3 = DNA1[1..k1]+DNA2[k2+1..] and DNA4 = DNA2[1..k2]+DNA1[k1+1..].<\/li>\n<li>mutate operation     they take a DNA, number k and one of the bases. Then they replace the base in position k in DNA with that base.<\/li>\n<li>also they need to know certain characteristics of those DNAs. So they can perform count operation     they take DNA and numbers k1 and k2 (k1 &lt;= k2). This operation should return the number of A, G, T, C bases in DNA[k1..k2].<\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<p>The initial DNAs are numbered from 1 to n, where n is the amount of those DNAs. The new DNAs created in the cross operations are numbered with consecutive integers. You are to write a program to help scientists perform those operations.<\/p>\n<h3>Input<\/h3>\n<p>The first line of input file contains number n     the amount of initial DNAs. Each of the following n lines contains the description of each DNA. The next line contains number q     the amount of operations to perform. The next q lines contain the description of each operation in the following form:<\/p>\n<ul>\n<li>CROSS id1 id2 k1 k2<\/li>\n<li>MUTATE id k m<\/li>\n<li>COUNT id k1 k2<\/li>\n<\/ul>\n<h3>Constraints<\/h3>\n<p>1 &lt;= n &lt;= 20<br \/> 1 &lt;= q &lt;= 30000<br \/> The length of each initial DNA does not exceed 30000. The length of any DNA formed in cross operation won   t exceed 2000000000. Total amount of different DNAs won   t exceed 10000. It is guaranteed that all operations are correct.<\/p>\n<h3>Output<\/h3>\n<p>For each count operation print four integers: the number of each of the bases in the given subsequence of the given DNA.<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n2\nCTCGC\nTGCGG\n5\nMUTATE 1 2 A\nCOUNT 2 2 4\nMUTATE 2 1 G\nCROSS 2 1 1 5\nCOUNT 4 3 6\n\n<b>Output:<\/b>\n0 2 0 1\n0 2 0 2\n\n<\/pre>\n<p><\/p>    ","languages_supported":"NA","title":"GENETICS","category":"NA","old_version":true,"problem_code":"GENETICS"}