{"category_name":"hard","status":"success","problem_code":"ANUSAR","problem_name":"Substrings and Repetitions","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><h3> Read problems statements in <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK46\/mandarin\/ANUSAR.pdf\">Mandarin Chinese<\/a> and <a target=\"_blank\" href=\"http:\/\/www.codechef.com\/download\/translated\/COOK46\/russian\/ANUSAR.pdf\">Russian<\/a> as well.<\/h3>\n<p><h3>Statement<\/h3>\n<\/p><p>Given a string <b>S<\/b> and several frequencies <b>F<sub>i<\/sub><\/b>. For each <b>F<sub>i<\/sub><\/b> output the number of substrings of <b>S<\/b> (the characters of substring should be contiguous) that occur at least <b>F<sub>i<\/sub><\/b> times in <b>S<\/b>. Note, that we consider two substrings distinct if they have distinct length, or they have distinct starting indices.<\/p>\n<h3>Input<\/h3>\n<p>The first line of input contains integer <b>T<\/b>, the number of test cases.<\/p>\n<p>The first line of each test case contains string <b>S<\/b> (it contains only lowercase Latin letters). The second line of each test case contains an integer <b>Q<\/b>, that is the number of queries to be answered. Then <b>Q<\/b> lines follows containing <b>F<sub>i<\/sub><\/b> each.<\/p>\n<h3>Output<\/h3>\n<p>For each query, output the required answer.<\/p>\n<h3>Constraints<\/h3>\n<ul>\n<li><b>1<\/b> \u2264 <b>|S|<\/b> \u2264 <b>200000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>Q<\/b> \u2264 <b>200000<\/b><\/li>\n<li><b>1<\/b> \u2264 <b>F<sub>i<\/sub><\/b> \u2264 <b>200000<\/b><\/li>\n<li><b>Sum of |S| over all test cases \u2264 200000<\/b><\/li>\n<li><b>Sum of Q over all test cases \u2264 200000<\/b><\/li>\n<\/ul>\n<p>\u00a0<\/p>\n<h3>Example<\/h3>\n<pre><b>Input:<\/b>\n1\naaeddf\n4\n1\n2\n3\n4\n\n<b>Output:<\/b>\n21\n4\n0\n0\n<\/pre><p>\u00a0<\/p>\n<h3>Explanation<\/h3>\n<p>There are a total of 6*(6+1)\/2 substrings, all of them occur at least once. So for <b>F<sub>1<\/sub>=1<\/b> answer is equal to 21. Note that substring <b>\"a\"<\/b> is repeated 2 times in <b>S<\/b>, both the instances are added to the answer.<\/p>\n<p>Look at <b>F<sub>2<\/sub>=2<\/b>. Substring <b>\"a\"<\/b> and substring <b>\"d\"<\/b> occurs 2 times each in <b>S<\/b>. The answer for <b>F<sub>2<\/sub><\/b> is 4, that is all the occurrences of <b>\"a\"<\/b> and <b>\"d\"<\/b>.<\/p>\n<p>There are no substrings which repeat more than twice. So rest answers are 0<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"1","source_sizelimit":"50000","problem_author":"anudeep2011","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>anudeep2011<\/span>","problem_tester":"gerald","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>gerald<\/span>","date_added":"3-03-2014","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/anudeep2011'>\n                    anudeep2011\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/cook46'>\n                    cook46\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/disjoint-set'>\n                    disjoint-set\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/medium-hard'>\n                    medium-hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/segment-tree'>\n                    segment-tree\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/stack'>\n                    stack\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/suffix-array'>\n                    suffix-array\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/suffix-trees'>\n                    suffix-trees\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/ANUSAR","user":{"username":null},"time":{"view_start_date":1400437800,"submit_start_date":1400437800,"visible_start_date":1400437800,"end_date":1735669800,"current":1493556613},"todo":false,"problem_status":"unattempted"}