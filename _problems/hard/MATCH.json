{"category_name":"hard","status":"success","problem_code":"MATCH","problem_name":"Expected Maximum Matching","body":"<span class=\"solution-visible-txt\">All submissions for this problem are available.<\/span><p>You are given two sets of vertexes <b>U = {U[1], U[2], ..., U[N]}<\/b> and <b>V = {V[1], V[2], ..., V[M]}<\/b>. All <b>N + M<\/b> vertexes here are different. You are also given the matrix <b>P<\/b> of size <b>N x M<\/b> composed of real numbers from the segment <b>[0, 1]<\/b>. The number that stands at the intersection of the <b>i<\/b><sup>th<\/sup> row and the <b>j<\/b><sup>th<\/sup> column of this matrix is denoted by <b>P[i][j]<\/b> and means the probability that the vertexes <b>U[i]<\/b> and <b>V[j]<\/b> are connected by the bidirected edge. In other words, you are given a <a href=\"http:\/\/en.wikipedia.org\/wiki\/Complete_bipartite_graph\">complete bipartite graph<\/a> where each edge occurs with some probability. Your task is to find <b>the expected size of the maximum matching<\/b> of this graph.<\/p>\n<p>What exactly does it mean?<\/p>\n<p>Let's call our complete bipartite graph with random edges as <i>random bipartite graph<\/i>.<br \/>\nConsider some arbitrary <a href=\"http:\/\/en.wikipedia.org\/wiki\/Bipartite_graph\">bipartite graph<\/a> <b>G = (U, V, E)<\/b>. Denote by <b>P(G)<\/b> the probability that our random bipartite graph is equal to <b>G<\/b>. How to calculate <b>P(G)<\/b>? Consider some pair of vertexes <b>(U[i], V[j])<\/b>. If these vertexes are connected by the edge in <b>G<\/b> then put <b>P<sub>G<\/sub>[i][j] = P[i][j]<\/b> otherwise put <b>P<sub>G<\/sub>[i][j] = 1 \u2013 P[i][j]<\/b>. Then <b>P(G)<\/b> is equal to the product of <b>P<sub>G<\/sub>[i][j]<\/b> for all <b>N \u2219 M<\/b> pairs of <b>(i, j)<\/b>, where <b>1 \u2264 i \u2264 N<\/b> and <b>1 \u2264 j \u2264 M<\/b>.<\/p>\n<p>Next, denote by <b>MM(G)<\/b> the size of the <a href=\"http:\/\/en.wikipedia.org\/wiki\/Maximum_matching#Definition\">maximum matching<\/a> in the graph <b>G<\/b>. In other words, <b>MM(G)<\/b> is the size of the largest set of edges of <b>G<\/b> such that no two edges share a common vertex. <\/p>\n<p>Finally, <b>the expected size of the maximum matching<\/b> is the sum of products <b>P(G) \u2219 MM(G)<\/b> for all possible bipartite graphs <b>G<\/b> with parts <b>U<\/b> and <b>V<\/b>. Note that there are <b>2<sup> N \u2219 M <\/sup><\/b> such graphs in all. So don't try to calculate the answer directly by definition if you do not want to get verdict <b>Time Limit Exceeded<\/b> ;)<\/p>\n<h3>Input<\/h3>\n<p>The first line of the input file contains two integers <b>N<\/b> and <b>M<\/b>. Each of the following <b>N<\/b> lines contains <b>M<\/b> real numbers. <b>j<\/b><sup>th<\/sup> number in the <b>i<\/b><sup>th<\/sup> line of these <b>N<\/b> lines denotes <b>P[i][j]<\/b>, the probability that the vertexes <b>U[i]<\/b> and <b>V[j]<\/b> are connected by the direct edge. Each pair of consecutive numbers in every line is separated by exactly one space.<\/p>\n<h3>Output<\/h3>\n<p>In the only line of the output file print the expected size of the maximum matching. Your answer will be considered as correct if it has an absolute error less than <b>10<sup>-6<\/sup><\/b>.<\/p>\n<h3>Constraints<\/h3>\n<p><b>1<\/b> \u2264 <b>N<\/b> \u2264 <b>5<\/b><\/p>\n<p><b>1<\/b> \u2264 <b>M<\/b> \u2264 <b>100<\/b><\/p>\n<p><b>0<\/b> \u2264 <b>P[i][j]<\/b> \u2264 <b>1<\/b><\/p>\n<p><b>P[i][j]<\/b> will have exactly <b>5<\/b> digits after the decimal point<\/p>\n<h3>Example<\/h3>\n<pre>\n<b>Input 1:<\/b>\n3 3\n0.38064 0.30000 0.29486\n0.41715 0.90000 0.67837\n0.53316 1.00000 1.00000\n\n<b>Output 1:<\/b>\n2.575940\n\n\n<b>Input 2:<\/b>\n2 2\n0.40000 1.00000\n0.10000 1.00000\n\n<b>Output 2:<\/b>\n1.46\n<\/pre><h3>Explanation<\/h3>\n<p>In the second example we have four different graphs with non-zero value of <b>P(G)<\/b>. Their adjacent matrices with marked maximum matching as well as the values of <b>MM(G)<\/b> and <b>P(G)<\/b> are listed in the table below.<\/p>\n<p>\n<table border=\"1\">\n<tbody>\n<tr>\n<td align=\"center\"><b>Adjacent matrix<\/b><\/td>\n<td align=\"center\"><b>MM(G)<\/b><\/td>\n<td align=\"center\"><b>P(G)<\/b><\/td>\n<\/tr>\n<tr>\n<td>\n<table border=\"1\" align=\"center\">\n<tbody>\n<tr>\n<td>0<\/td>\n<td bgcolor=\"yellow\">1<\/td>\n<\/tr>\n<tr>\n<td>0<\/td>\n<td>1<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<\/td>\n<td align=\"center\"><b>1<\/b><\/td>\n<td align=\"right\">(1 \u2013 0.4) \u2219 (1 \u2013 0.1) = 0.6 \u2219 0.9 = <b>0.54<\/b><\/td>\n<\/tr>\n<tr>\n<td>\n<table border=\"1\" align=\"center\">\n<tbody>\n<tr>\n<td bgcolor=\"yellow\">1<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>0<\/td>\n<td bgcolor=\"yellow\">1<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<\/td>\n<td align=\"center\"><b>2<\/b><\/td>\n<td align=\"right\">0.4 \u2219 (1 \u2013 0.1) = 0.4 \u2219 0.9 = <b>0.36<\/b><\/td>\n<\/tr>\n<tr>\n<td>\n<table border=\"1\" align=\"center\">\n<tbody>\n<tr>\n<td>0<\/td>\n<td bgcolor=\"yellow\">1<\/td>\n<\/tr>\n<tr>\n<td bgcolor=\"yellow\">1<\/td>\n<td>1<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<\/td>\n<td align=\"center\"><b>2<\/b><\/td>\n<td align=\"right\">(1 \u2013 0.4) \u2219 0.1 = 0.6 \u2219 0.1 = <b>0.06<\/b><\/td>\n<\/tr>\n<tr>\n<td>\n<table border=\"1\" align=\"center\">\n<tbody>\n<tr>\n<td bgcolor=\"yellow\">1<\/td>\n<td>1<\/td>\n<\/tr>\n<tr>\n<td>1<\/td>\n<td bgcolor=\"yellow\">1<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<\/td>\n<td align=\"center\"><b>2<\/b><\/td>\n<td align=\"right\">0.4 \u2219 0.1 = <b>0.04<\/b><\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<\/p>\n<p>So the answer is <b>0.54 \u2219 1 + 0.36 \u2219 2 + 0.06 \u2219 2 + 0.04 \u2219 2 = 1.46<\/b>.<\/p>\n","languages_supported":"ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYTH, PYTH 3.4, RUBY, SCALA, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC","max_timelimit":"3","source_sizelimit":"50000","problem_author":"shangjingbo","problem_author_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #3366CC;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>3&#9733;<\/span><span>shangjingbo<\/span>","problem_tester":"anton_lunyov","problem_tester_html_handle":"<span \n            class='rating' \n            style='display: inline-block; \n                    font-size: 10px; \n                    background: #FF7F00;\n                    padding: 0 3px; \n                    line-height: 1.3; \n                    color: white;\n                    margin-right: 2px;'>6&#9733;<\/span><span>anton_lunyov<\/span>","date_added":"29-03-2012","tags":"<a class='problem-tag-small ' href='\/tags\/problems\/hard'>\n                    hard\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/june12'>\n                    june12\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/matching'>\n                    matching\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/probability'>\n                    probability\n                <\/a><a class='problem-tag-small ' href='\/tags\/problems\/shangjingbo'>\n                    shangjingbo\n                <\/a>","editorial_url":"http:\/\/discuss.codechef.com\/problems\/MATCH","user":{"username":null},"time":{"view_start_date":1339403792,"submit_start_date":1339403792,"visible_start_date":1339407000,"end_date":1735669800,"current":1493556766},"todo":false,"problem_status":"unattempted"}